import{_ as Sa}from"./CikNTp_N.js";import{D as qa,S as La,a as Fa,_ as Pa}from"./D-Tgru-p.js";import{_ as Ba}from"./DSPHs38f.js";import{_ as Va}from"./BFU05jqY.js";import{f as Ua,u as $a,h as Ia,r as n,L as Aa,G,M as la,e as Ma,c as u,o as l,l as d,a as t,k as N,b,I as x,d as $,t as k,w as za,z as Ta,ak as Ja,p as Ga,A as Na,F as W,q as oa,B as Wa,S as Ka,n as Ha,m as Ra}from"#entry";import{C as Xa}from"./B4fb4Jub.js";import{u as Ya}from"./CUA_6ykz.js";import{u as Qa}from"./C-MlBdbB.js";import{d as Oa}from"./DoL2xymK.js";import"./BzLCLO6P.js";import"./QraDVNg7.js";import"./DlAUqK2U.js";const Za={key:0},ae={class:"navbar fixed-top"},ee={class:"py-4 position-relative mt-3"},te={key:1,class:"camera-container"},ne={class:"camera-wrapper"},se={key:2,class:"row justify-content-center mb-5"},le={class:"col-12 col-xl-7"},oe={class:"tab-content",id:"quizTabContent"},ie={class:"p-3"},ue={class:"p-3"},re={class:"quiz-tabs fixed-bottom bg-white border-top py-2 px-3 shadow-sm",id:"bottom-nav"},ce={class:"d-flex justify-content-between align-items-center flex-wrap"},de={class:"btn-group",role:"group","aria-label":"Basic example"},me={class:"nav-left",id:"navLeft"},pe={class:"quiz-meta mb-3"},ve={class:"quiz-mapel text-center"},fe={style:{height:"100%","overflow-y":"auto"}},_e={key:0,class:"mb-3"},ge={class:"kotak-wrapper"},be=["onClick","disabled"],ke={key:1},we={class:"kotak-wrapper"},he=["onClick","disabled"],ye={key:1,class:"modal fade show",tabindex:"-1",style:{display:"block","background-color":"rgba(0,0,0,0.5)"}},xe={class:"modal-dialog modal-dialog-centered"},je={class:"modal-content"},De={class:"modal-header"},Ee={class:"modal-body position-relative text-center"},Ce={key:0},Se={key:0,class:"mb-2"},qe={key:1,class:"mb-3"},Le={key:1,class:"mb-3 text-success fw-bold"},Fe={class:"d-flex justify-content-center gap-2"},Pe={key:1,class:"d-flex justify-content-center align-items-center",style:{"min-height":"100px"}},Re=Ua({__name:"answer",setup(Be){Ya({title:"Menjawab Kuis "}),Qa();const{$axiosAuth:C}=$a(),K=Ia(),p=Aa(),j=Wa(),H=n({}),w=p.params.id,S=n({run:!1,mulai:"",selesai:""});n(1);const ia=n("pilihan_ganda"),L=n(!1),R=n({});n({});const X=n({}),I=n([]),A=n({}),v=n({}),f=n([]),D=n(!1),m=n({mulai:!0,camera:!1,selesai:!1}),E=n({fullscreen:!1,status:!0}),F=n(0),ua=n(!1),M=n(""),_=n({page_pg:null,page_ur:null,page_list:1}),h=n({pra_mulai:!1,mulai:!1,selesai:!1,tutup:!1}),Y=n({waktu_mulai:"",waktu_selesai:""}),q=n(p.query.tab||"pilihan_ganda"),Q=n(!1);n(!1);const z=n({nama:"",image_show:"",nama_inisial:"",color:"",izin_balas:!1,list:[]});async function ra(){m.value.mulai=!0;const e=new FormData;e.append("unggahan_id",w);try{let i=(await C({method:"post",url:"/unggahan/kuis/answer/check",data:e})).data.data,c=await i?.jawab;R.value=c;let g=c?.status;if(z.value.jawab_id=c.id,z.value.list=c?c.pesan:[],g!="mulai"){j.push({name:"kuis-persiapan",params:{id:w}});return}let r=i?.kuis,s=r?.jawab,sa=r?.mulai,Ve=r?.akhir,U=c?.status;if(M.value=r?.swafoto_aksi,X.value=r,L.value=s,r?.layar_penuh?E.value.status=!0:E.value.status=!1,U=="tutup"?h.value.tutup=!0:U=="selesai"&&(h.value.selesai=!0),U=="selesai"||U=="tutup"){m.value.mulai=!1,ua.value=!0;return}m.value.mulai=!1,F.value=i?.jawab?.swafoto,Y.value=await{waktu_mulai:r.waktu_mulai_iso,waktu_selesai:r.waktu_selesai_realisasi_iso};let Ca=r.pg_total_soal,Ue=r.ur_total_soal;p.query.tab||j.replace({query:{...p.query,tab:Ca>0?"pilihan_ganda":"uraian"}})}catch(a){console.error(a.response?.data||a.message),m.value.mulai=!1}}const y=n({}),P=n(!1);async function O(){m.value.selesai=!0,P.value=!0;const e=new FormData;e.append("unggahan_id",w);try{let o=(await C({method:"post",url:"/unggahan/kuis/answer/cek-soal",data:e})).data;y.value=o}catch(a){console.error(a.response?.data||a.message)}m.value.selesai=!1}async function ca(){E.value.status=!1;const e=new FormData;e.append("unggahan_id",w);try{const a=await C({method:"post",url:"/unggahan/kuis/answer/selesai",data:e});T()}catch(a){console.error(a.response?.data||a.message)}}async function da(e){const a=new FormData;a.append("unggahan_id",w),a.append("pelanggaran",e.keterangan),a.append("jumlah",e.jumlah);try{const o=await C({method:"post",url:"/unggahan/kuis/pelanggaran/store",data:a})}catch(o){console.error(o.response?.data||o.message)}}G(()=>p.query.tab,e=>{e&&(q.value=e)});function ma(){const e=S.value.mulai,a=S.value.selesai;h.value={pra_mulai:!1,mulai:!1,selesai:!1,tutup:!1},e!=="00:00:00"?h.value.pra_mulai=!0:a!=="00:00:00"?h.value.mulai=!0:e==="00:00:00"&&a==="00:00:00"&&L.value?(h.value.selesai=!0,T()):e==="00:00:00"&&a==="00:00:00"&&!L.value&&(h.value.tutup=!0,T())}function pa(e){e.stopPropagation(),document.getElementById("navLeft").classList.toggle("open")}function va(){document.getElementById("navLeft")?.classList.remove("open")}document.addEventListener("click",function(e){if(window.innerWidth>768)return;const a=document.querySelector(".nav-left");if(!a)return;["nav-left","nav-toggle","nav-btn"].some(c=>e.target.closest("."+c))||a.classList.remove("open")});async function fa(e){I.value=e;let a=F.value;e.some(i=>i.nomor==a)&&M.value!="off"&&(D.value=!0)}async function _a(e){A.value=e;let a=F.value;e.some(i=>i.nomor==a)&&M.value!="off"&&(D.value=!0,Ka.fire({title:"Silahkan foto diri untuk melanjutkan!",icon:"warning",draggable:!0}))}async function ga(e){v.value=e}async function ba(e){f.value=e}let B=!1;async function ka(e){if(B||!D.value)return;B=!0,m.value.camera=!0;const a=new FormData;a.append("image",e.base64),a.append("unggahan_id",w);try{let i=(await C({method:"post",url:"/unggahan/kuis/answer/swafoto",data:a})).data,c=i?.status,g=i?.nomor;m.value.camera=!1,c==!0?(D.value=!1,F.value=g):B=!1}catch(o){console.error(o.response?.data||o.message),m.value.camera=!1}finally{m.value.camera=!1,B=!1}}const wa=n(0);async function ha(e){S.value=e,wa.value=parseInt(e.selesai.split(":")[1],10),ma()}async function T(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():console.log("Bukan dalam mode fullscreen"),j.push({name:"kuis-persiapan",params:{id:w}})}function Z(e){e=="selesai"&&O()}n({clientX:0,clientY:0,movementX:0,movementY:0}),n(null);function ya(){document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}la(()=>{ya()}),G(_,(e,a)=>{j.replace({query:{...p.query,page_list:e.page_list}})},{deep:!0});function aa(e){ia.value=e,Ha({query:{...p.query,tab:e}})}function xa(e){let a=Math.ceil(e/v.value.per_page);j.replace({query:{...p.query,page_pg:a,nomor_pg:e,tab:"pilihan_ganda"}})}function ja(e){let a=Math.ceil(e/f.value.per_page);j.replace({query:{...p.query,page_ur:a,nomor_ur:e,tab:"uraian"}})}const Da=Oa(async()=>{H.value=await K.get("profil")?.data},300);G(()=>Ra(K.get("profil")),(e,a)=>{H.value=e?.data},{deep:!0});function V(e,a,o){let i=a?.find(r=>r.nomor==o),g=e?.jenis_soal=="adaptif";return{jawab:!!i?.jawab,disabled:i?.jawab||i?.nomor?!1:!!g}}function Ea(e){const[a,o,i]=e.split(":").map(Number);return a*60+o+Math.floor(i/60)}let J=null;async function ea(){if(!("wakeLock"in navigator)){console.log("⚠️ Browser tidak mendukung Wake Lock API");return}try{J=await navigator.wakeLock.request("screen"),console.log("✅ Wake lock aktif"),J.addEventListener("release",()=>{console.log("⚠️ Wake lock dilepas")})}catch(e){console.error("❌ Gagal aktifkan wake lock:",e)}}const ta=document.documentElement;function na(){ta&&E.value.status&&(document.fullscreenElement||ta.requestFullscreen().catch(e=>{console.warn("Gagal masuk fullscreen:",e)}))}return Ma(async()=>{p.query.page_list&&(_.value.page_list=Number(p.query.page_list)),await Da(),await ra(),Q.value=!0,document.addEventListener("click",ea,{once:!0}),document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&J===null&&await ea()}),document.addEventListener("click",na)}),la(()=>{document.removeEventListener("click",na)}),(e,a)=>{const o=Sa,i=Pa,c=Ba,g=Va,r=Na("font-awesome-icon");return l(),u("div",null,[L.value?(l(),u("div",Za,[t("nav",ae,[t("div",{class:x(["right-top",[Ea(S.value?.selesai)<5?"border-blink-red":""]])},[$(k(S.value.selesai)+" ",1),t("button",{class:"btn btn-sm btn-secondary",onClick:a[0]||(a[0]=s=>O())},"Selesai")],2)]),Q.value?(l(),N(o,{key:0,data:z.value},null,8,["data"])):d("",!0),b(c,null,{default:za(()=>[b(i,{waktu:Y.value,onTime_left:ha},null,8,["waktu"])]),_:1}),t("div",ee,[E.value.status?(l(),N(qa,{key:0,data:R.value,fullscreen:E.value.fullscreen,onPelanggaran:da},null,8,["data","fullscreen"])):d("",!0),D.value?(l(),u("div",te,[t("div",ne,[b(Xa,{onCapture:ka}),m.value.camera?(l(),N(g,{key:0,class:"position-center",style:{"z-index":"1200"}})):d("",!0)])])):d("",!0),D.value?d("",!0):(l(),u("div",se,[t("div",le,[t("div",oe,[t("div",{class:x({"tab-pane":!0,fade:!0,"show active":q.value==="pilihan_ganda"}),id:"pilihan_ganda",role:"tabpanel","aria-labelledby":"tab-pg"},[t("div",ie,[b(La,{onJawab:fa,onData:ga,onInput:Z,modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=s=>_.value=s)},null,8,["modelValue"])])],2),t("div",{class:x({"tab-pane":!0,fade:!0,"show active":q.value==="uraian"}),id:"uraian",role:"tabpanel","aria-labelledby":"tab-uraian"},[t("div",ue,[b(Fa,{onJawab:_a,onData:ba,onInput:Z,modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=s=>_.value=s)},null,8,["modelValue"])])],2)])])])),t("div",re,[t("div",ce,[t("button",{type:"button",class:"btn",onClick:a[3]||(a[3]=s=>pa(s))}," ▶️ JAWAB "),t("div",null,[t("div",de,[v.value.jumlah_soal>0?(l(),u("button",{key:0,onClick:a[4]||(a[4]=s=>aa("pilihan_ganda")),class:x([q.value=="pilihan_ganda"?"active ":"","nav-link mx-2"]),id:"tab-pg","data-bs-toggle":"tab","data-bs-target":"#pilihan_ganda",type:"button",role:"tab","aria-controls":"soal_pilihan_ganda","aria-selected":"true"},[t("strong",null," Pilihan G. ("+k(v.value.jumlah_soal)+") ",1)],2)):d("",!0),f.value.jumlah_soal>0?(l(),u("button",{key:1,onClick:a[5]||(a[5]=s=>aa("uraian")),class:x([q.value=="uraian"||v.value.jumlah_soal==0?"active":"","nav-link mx-2"]),id:"tab-uraian","data-bs-toggle":"tab","data-bs-target":"#uraian",type:"button",role:"tab","aria-controls":"soal_uraian","aria-selected":"false"},[t("strong",null,[t("b",null," Uraian ("+k(f.value.jumlah_soal)+") ",1)])],2)):d("",!0)])]),t("div",null,[a[12]||(a[12]=$(" List ",-1)),Ta(t("select",{"onUpdate:modelValue":a[6]||(a[6]=s=>_.value.page_list=s),style:{"border-radius":"5px"}},[...a[11]||(a[11]=[Ga('<option value="1"> 1</option><option value="5"> 5</option><option value="10"> 10</option><option value="50"> 50</option><option value="100"> 100</option>',5)])],512),[[Ja,_.value.page_list]])])])])]),t("div",me,[t("button",{type:"button",class:"btn right-top",onClick:a[7]||(a[7]=s=>va())},[b(r,{class:"fa-2x",icon:["fas","circle-xmark"]})]),t("div",pe,[t("div",ve,[t("strong",null,k(X.value?.mata_pelajaran),1)])]),t("div",fe,[v.value.jumlah_soal>0?(l(),u("div",_e,[a[13]||(a[13]=t("label",null,"Pilihan Ganda",-1)),t("div",ge,[(l(!0),u(W,null,oa(v.value.jumlah_soal,s=>(l(),u("div",null,[t("button",{type:"button",onClick:sa=>xa(s),class:x([V(v.value,I.value,s)?.jawab?"btn btn-primary":"","kotak-kecil"]),disabled:V(v.value,I.value,s)?.disabled},k(s),11,be)]))),256))])])):d("",!0),f.value.jumlah_soal>0?(l(),u("div",ke,[a[14]||(a[14]=t("label",null,"Uraian",-1)),t("div",we,[(l(!0),u(W,null,oa(f.value.jumlah_soal,s=>(l(),u("div",null,[t("button",{type:"button",onClick:sa=>ja(s),class:x([V(f.value,A.value,s)?.jawab?"btn btn-primary":"","kotak-kecil"]),disabled:V(f.value,A.value,s)?.disabled},k(s),11,he)]))),256))])])):d("",!0)])]),P.value?(l(),u("div",ye,[t("div",xe,[t("div",je,[t("div",De,[b(r,{class:"fa-2x text-warning me-2",icon:["fas","triangle-exclamation"]}),a[15]||(a[15]=t("h5",{class:"modal-title w-100 text-center mb-0"},"Apakah Anda yakin?",-1)),t("button",{type:"button",class:"btn-close",onClick:a[8]||(a[8]=s=>P.value=!1)})]),t("div",Ee,[m.value.selesai?(l(),u("div",Pe,[b(g)])):(l(),u(W,{key:0},[y.value?.pilihan_ganda?.belum_dijawab||y.value?.uraian?.belum_dijawab?(l(),u("div",Ce,[y.value?.pilihan_ganda?.status?(l(),u("div",Se,[a[16]||(a[16]=$(" Soal pilihan ganda belum dijawab: ",-1)),t("strong",null,k(y.value?.pilihan_ganda?.belum_dijawab),1)])):d("",!0),y.value?.uraian?.status?(l(),u("div",qe,[a[17]||(a[17]=$(" Soal uraian belum dijawab: ",-1)),t("strong",null,k(y.value?.uraian?.belum_dijawab),1)])):d("",!0)])):(l(),u("div",Le," Sempurna! Semua soal telah dikerjakan 🎉 ")),t("div",Fe,[t("button",{class:"btn btn-success btn-sm",onClick:a[9]||(a[9]=s=>ca())},"Selesai"),t("button",{class:"btn btn-danger btn-sm",onClick:a[10]||(a[10]=s=>P.value=!1)},"Batal")])],64))])])])])):d("",!0)])):d("",!0)])}}});export{Re as default};
