import{_ as la}from"./BwT3rymJ.js";import{_ as ia}from"./QraDVNg7.js";import{_ as ra}from"./DBDT5h3r.js";import{_ as O}from"./BFU05jqY.js";import{u as R,r as m,s as w,e as Y,c as d,o,l as y,k as D,F as W,q as G,a,I as P,t as l,z as J,f as da,h as ca,j as ua,i as pa,x as K,y as ga,b as r,v as E,K as _a,d as ma,w as N,m as fa,S as va,n as ka}from"#entry";import{_ as ha}from"./DlAUqK2U.js";import{_ as V}from"./BbXXgusc.js";import{d as ya}from"./DoL2xymK.js";const ba={class:"container"},xa={class:"d-flex align-items-center gap-3"},wa={class:"user-name"},Ca={class:"points"},$a={class:"flex-grow-1 ms-3"},Ba={class:"progress"},Da={key:0,class:"text-center text-muted mt-4"},Sa={__name:"PeringkatNilai",props:{data:{type:Object,required:!1,default:()=>({})}},setup(A){const C=A,{$axiosAuth:f}=R(),b=m([]),v=m({...C.data}),$=m({peringkat:!1});w(()=>C.data,p=>{v.value={...p},p?.id&&S()},{deep:!0,immediate:!0});async function S(){$.value.peringkat=!0;const p=new FormData;p.append("unggahan_id",C.data?.id);try{const c=await f({method:"post",url:"/unggahan/kuis/peringkat",data:p});b.value=c.data||[],$.value.peringkat=!1}catch(c){console.error(c.response?.data||c.message),$.value.peringkat=!1}}function z(p){if(!b.value.length)return 0;const c=Math.max(...b.value.map(u=>u.total_skor||0));return c?(p/c*100).toFixed(1):0}function T(p){const c=["bg-primary","bg-success","bg-info","bg-warning","bg-danger","bg-secondary"];return c[p%c.length]}return Y(async()=>{C.data?.id&&await S()}),(p,c)=>{const u=O;return o(),d("div",ba,[(o(!0),d(W,null,G(b.value,(g,h)=>(o(),d("div",{key:h,class:"ranking-card d-flex align-items-center justify-content-between"},[a("div",xa,[a("div",{class:P(["rank-badge","rank-"+(h+1)])},l(h+1),3),a("div",null,[a("div",wa,l(g.nama),1),a("div",Ca,l(g.total_skor)+" pts",1)])]),a("div",$a,[a("div",Ba,[a("div",{class:P(["progress-bar",T(h)]),role:"progressbar",style:J({width:z(g.total_skor)+"%"})},null,6)])])]))),128)),b.value?.length?y("",!0):(o(),d("div",Da)),$.value.peringkat?(o(),D(u,{key:1,class:"position-center"})):y("",!0)])}}},za=ha(Sa,[["__scopeId","data-v-f30f34da"]]),Ia={class:"position-relative"},Na={class:"search-bar mb-1 mb-md-3 position-relative"},Pa={key:0,class:"mb-3"},ja={class:"card",style:{"min-height":"300px"}},qa={class:"card-body position-relative"},Fa={class:"position-center"},Aa={key:1,class:"mb-3"},Ta={key:0},Ma={class:"card shadow-sm"},La={class:"card-body"},Ua={class:"d-flex justify-content-between align-items-start"},Va={class:"row align-items-start"},Wa={class:"col-auto"},Ha=["onClick"],Ka=["onClick"],Ea={class:"col"},Oa=["onClick"],Ra={class:"text-muted small"},Ya={class:"text-muted small"},Ga={class:"mb-2"},Ja={class:"quiz-meta d-none d-md-block"},Qa={class:"quiz-mapel"},Xa={class:"quiz-meta d-md-none d-block"},Za={class:"quiz-mapel text-center"},at={class:"text-center"},tt={class:"row"},et={class:"col-sm-12 p-2"},st={class:"notebook position-relative"},nt={class:"d-flex justify-content-between align-items-center mt-3"},ot={class:"d-flex gap-3 flex-wrap text-secondary position-relative"},lt=["onClick"],it={class:"ms-1"},rt=["onClick"],dt={class:"ms-1"},ct=["onClick"],ut={class:"ms-1"},pt={key:0,class:"position-absolute top-0 end-0 m-4"},gt={class:"dropdown"},_t={role:"button","data-bs-toggle":"dropdown"},mt={class:"dropdown-menu shadow-sm"},ft=["onClick"],vt=["onClick"],kt=["onClick"],ht=["onClick"],yt={key:2,class:"m-2 float-end"},bt={class:"modal fade",id:"peringkat","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},xt={class:"modal-dialog modal-dialog-scrollable"},wt={class:"modal-content"},Ct={class:"modal-header position-relative text-center"},$t={type:"button",class:"btn right-top","data-bs-dismiss":"modal","aria-label":"Close"},Bt={class:"modal-body"},Dt=da({__name:"PostingsShow",props:{loading:{type:Boolean,default:!1}},emits:["pageHome"],setup(A,{emit:C}){const f=ya(()=>{q()},300),b=A,v=ca(),$=ua(),S=pa(),z=S.params.user,T=m(1),p=m({page:1}),c=m({}),u=m({data:[]}),g=m({}),h=m(""),{$axiosAuth:j}=R(),_=m({cari:"",page:1});z?h.value="/profil/"+z+"/unggahan":h.value="/unggahan/terkirim";async function q(){g.value.unggahan=!0;try{let t=(await j({method:"post",url:h.value,params:_.value})).data;t.status==!0?u.value=t?.data:c.value=t,g.value.unggahan=!1}catch(s){console.log(s.response?.data),g.value.unggahan=!1}}async function Q(s,t){g.value.unggahan=!0;const n=new FormData;n.append("id",s);try{let B=(await j({method:"post",url:"/unggahan/draf/back",data:n})).data;q(),ta(),g.value.unggahan=!1}catch(i){console.error(i.response?.data||i.message),g.value.posting_sent=!1,g.value.unggahan=!1}}async function X(s){if((await va.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const n=await j({method:"delete",url:"/unggahan/"+s+"/delete"});q()}catch(n){console.error(n.response?.data||n.message)}}async function M(s,t,n){let i=u.value.data[s];i.loading=!0;const B=new FormData;B.append("unggahan_id",t),B.append("reaksi",n);try{let x=(await j({method:"post",url:"/unggahan/reaksi/store",data:B})).data;i.tidak_suka_count=x.tidak_suka,i.suka_count=x.suka,i.reaksi_ku=x.reaksi,i.mark=x.mark,i.loading=!1,n=="mark"&&v.set("tanda",x.mark)}catch(I){console.error(I.response?.data||I.message),i.loading=!1}}async function L(s){await ka("/"+s)}function Z(){_.value.cari=""}Y(async()=>{let s=S.query.page;s&&(T.value=Number(s)||1),f()}),w(()=>v.get("refresh-page"),(s,t)=>{s!=t&&f()}),w(()=>b.loading,(s,t)=>{s!==t&&f()}),w(_,(s,t)=>{p.value.page=s.page,$.push({query:{page:s.page}}),f()},{deep:!0}),w(()=>v.get("tanda"),(s,t)=>{s!==t&&f()});const U=m(!1);w(()=>v.get("cari_unggahan"),s=>{s?_.value.cari!==s&&(U.value=!0,_.value.cari=s,f()):_.value.cari=null}),w(()=>_.value.cari,(s,t)=>{s!==t&&(U.value?U.value=!1:(v.get("cari_unggahan")&&v.clear("cari_unggahan"),v.set("cari",!0),f()))});const aa=C;function ta(){aa("pageHome")}const ea=async s=>{if(navigator.share)try{await navigator.share({url:s})}catch(t){console.log("User batal share",t)}else window.open("https://wa.me/?text="+window.location.origin+s,"_blank")},H=m({});function sa(s){H.value=s}return(s,t)=>{const n=E("font-awesome-icon"),i=la,B=ia,I=ra,x=E("FontAwesomeIcon"),na=za,oa=_a("lazy");return o(),d("div",Ia,[a("div",Na,[K(a("input",{type:"text",onKeyup:t[0]||(t[0]=e=>q()),"onUpdate:modelValue":t[1]||(t[1]=e=>_.value.cari=e),placeholder:"Cari Unggahan ID / Nama"},null,544),[[ga,_.value.cari]]),_.value.cari?(o(),d("button",{key:0,onClick:t[2]||(t[2]=e=>Z()),type:"button",class:"btn right-center-20"},[r(n,{icon:["fas","circle-xmark"],class:"text-secondary"})])):y("",!0)]),c.value.message?(o(),d("div",Pa,[a("div",ja,[a("div",qa,[a("div",Fa,[a("div",null,[r(n,{icon:["fas","users-slash"],class:"fa-4x text-secondary"})]),a("div",null,l(c.value.message),1)])])])])):(o(),d("div",Aa,[a("div",null,[u.value.data.length<1?(o(),d("div",Ta,[...t[4]||(t[4]=[a("div",{class:"card",style:{"min-height":"300px"}},[a("div",{class:"card-body d-flex justify-content-center align-items-center"},[a("div",{class:"text-center"}," Belum ada unggahan ")])],-1)])])):(o(!0),d(W,{key:1},G(u.value.data,(e,F)=>(o(),d("div",{class:"list-group-item position-relative mb-3",key:F},[a("div",Ma,[a("div",La,[a("div",Ua,[a("div",Va,[a("div",Wa,[e.profil.image_show?K((o(),d("img",{key:0,class:"profil-img avatar-50 lazy-img",onClick:k=>L(e.profil.username)},null,8,Ha)),[[oa,e.profil.image_show]]):(o(),d("div",{key:1,style:J({backgroundColor:e.profil.color}),class:"avatar-50 profile-img",onClick:k=>L(e.profil.username)},l(e.profil.nama_inisial),13,Ka))]),a("div",Ea,[a("div",{class:"fw-bold cursor-pointer",onClick:k=>L(e.profil.username)},l(e.profil.nama_lengkap),9,Oa),a("div",Ra," ID: "+l(e.id_ref),1),a("div",Ya,l(e.created_at_for_humans),1)]),t[5]||(t[5]=a("div",{class:"text-muted small"},null,-1))]),t[6]||(t[6]=a("div",{class:"col-sm-6 text-muted small",style:{"margin-top":"-10px","padding-top":"-10px !important"}},null,-1))]),t[10]||(t[10]=a("hr",{class:"my-2"},null,-1)),a("div",Ga,[a("div",Ja,[a("span",Qa,l(e.kuis?.mata_pelajaran),1),ma(" ⏰ "+l(e.kuis?.mulai_formated_2)+" WIB – "+l(e.kuis?.tutup_formated_2)+" WIB ",1)]),a("div",Xa,[a("div",Za,l(e.kuis?.mata_pelajaran),1),a("div",at," ⏰ "+l(e.kuis?.mulai_formated_2)+" WIB – "+l(e.kuis?.tutup_formated_2)+" WIB ",1)]),a("div",tt,[a("div",et,[a("div",st,[a("div",null,l(e.text||""),1)])])])]),a("div",nt,[a("div",null,[a("div",null,[e?.kuis?.status_aksi=="tutup"?(o(),D(i,{key:0,to:`/${e.profil.username}/unggahan/kuis/${e.id}`,class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:N(()=>[...t[7]||(t[7]=[a("img",{src:V,width:"20",height:"20"},null,-1),a("span",null," Tutup",-1)])]),_:1},8,["to"])):e?.kuis?.status_aksi=="berlangsung"?(o(),D(i,{key:1,to:`/${e.profil.username}/unggahan/kuis/${e.id}`,class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:N(()=>[...t[8]||(t[8]=[a("img",{src:V,width:"20",height:"20"},null,-1),a("span",null," Berlangsung",-1)])]),_:1},8,["to"])):(o(),D(i,{key:2,to:`/${e.profil.username}/unggahan/kuis/${e.id}`,class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:N(()=>[...t[9]||(t[9]=[a("img",{src:V,width:"20",height:"20"},null,-1),a("span",null," Belum dimulai",-1)])]),_:1},8,["to"]))])]),a("div",ot,[a("button",{class:"btn p-0 text-secondary",onClick:k=>M(F,e.id,"suka"),title:"Suka"},[r(n,{icon:["fas","heart"],class:P({"text-danger":e.reaksi_ku==="suka"})},null,8,["class"]),a("span",it,l(e.suka_count),1)],8,lt),a("button",{class:"btn p-0 text-secondary",onClick:k=>M(F,e.id,"tidak suka"),title:"Tidak Suka"},[r(n,{icon:["fas","heart-crack"],class:P({"text-danger":e.reaksi_ku==="tidak suka"})},null,8,["class"]),a("span",dt,l(e.tidak_suka_count),1)],8,rt),a("button",{class:"btn p-0 text-secondary",onClick:k=>M(F,e.id,"mark"),title:"Favorit"},[r(n,{icon:["fas","bookmark"],class:P({"text-danger":e.mark})},null,8,["class"])],8,ct),r(i,{to:`/${e.profil.username}/unggahan/${e.id}`,class:"text-secondary text-decoration-none small",title:"Komentar"},{default:N(()=>[r(n,{icon:["fas","comments"]}),a("span",ut,l(e.tanggapan_all_count??0),1)]),_:2},1032,["to"]),e.loading?(o(),D(B,{key:0,class:"position-center"})):y("",!0)])])]),fa(z)?y("",!0):(o(),d("div",pt,[a("div",gt,[a("a",_t,[r(n,{icon:["fas","ellipsis-vertical"],class:"text-secondary"})]),a("ul",mt,[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>ea(`/${e.profil.username}/unggahan/${e.id}`)},[r(n,{icon:["fas","share-nodes"]}),t[11]||(t[11]=a("span",null,"Bagikan",-1))],8,ft)]),a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>sa(e),"data-bs-toggle":"modal","data-bs-target":"#peringkat"},[r(n,{icon:["fas","ranking-star"]}),t[12]||(t[12]=a("span",null,"Peringkat",-1))],8,vt)]),e.miliku?(o(),d(W,{key:0},[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>Q(e.id,e.text)},[r(n,{icon:["fas","file-pen"]}),t[13]||(t[13]=a("span",null,"Kembalikan ke Draf",-1))],8,kt)]),a("li",null,[r(i,{to:{name:"kuis-laporan",params:{id:e.id}},class:"dropdown-item d-flex align-items-center gap-2"},{default:N(()=>[r(n,{icon:["fas","chart-line"]}),t[14]||(t[14]=a("span",null,"Laporan",-1))]),_:1},8,["to"])]),a("li",null,[a("a",{href:"#",class:"dropdown-item text-danger d-flex align-items-center gap-2",onClick:k=>X(e.id)},[r(n,{icon:["fas","trash"]}),t[15]||(t[15]=a("span",null,"Hapus",-1))],8,ht)])],64)):y("",!0)])])]))])]))),128))])])),u.value.total>u.value.per_page?(o(),d("div",yt,[r(I,{modelValue:_.value.page,"onUpdate:modelValue":t[3]||(t[3]=e=>_.value.page=e),"total-items":u.value.total?u.value.total:1,"items-per-page":u.value.per_page?u.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):y("",!0),g.value.unggahan?(o(),D(O,{key:3,class:"position-center"})):y("",!0),a("div",bt,[a("div",xt,[a("div",wt,[a("div",Ct,[t[16]||(t[16]=a("h2",{class:"text-center mb-4"},"🏆 Leaderboard",-1)),a("button",$t,[r(x,{icon:["fa","circle-xmark"],class:"fa-2x"})])]),a("div",Bt,[r(na,{data:H.value},null,8,["data"])])])])])])}}}),At=Object.assign(Dt,{__name:"PostingsShow"});export{At as P};
