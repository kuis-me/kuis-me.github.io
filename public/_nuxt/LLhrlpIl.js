import{_ as R}from"./BTT6KBUK.js";import{_ as W}from"./DBDT5h3r.js";import{f as X,r as u,u as Z,s as C,h as tt,e as at,c as d,o as l,l as v,a,x as $,k as P,y as q,I as h,t as x,b as r,d as _,v as et,F,q as st,w as S,S as nt,m as ot}from"#entry";import{u as lt}from"./CUA_6ykz.js";import{_ as N}from"./BFU05jqY.js";/* empty css        */import{P as it}from"./BqIUD2YV.js";import"./Dda1HtW4.js";import"./C31_JZqf.js";import"./BLmUUPHe.js";import{P as ut}from"./CfXRr_Ay.js";import{u as rt}from"./C-MlBdbB.js";import{d as L}from"./DoL2xymK.js";/* empty css        */import"./DlAUqK2U.js";import"./QraDVNg7.js";import"./BbXXgusc.js";import"./DTCu01cd.js";import"./cmuNVbBL.js";import"./B1oisLxj.js";import"./W0NU78oz.js";import"./DsmCZfJr.js";const dt={class:"container-fluid px-0"},ct={key:0,class:"card mb-1 mb-md-3"},pt={class:"card-body"},mt={key:0,class:"upload-card"},gt={class:"position-relative"},vt={class:"upload-footer d-flex justify-content-between align-items-center mt-2"},_t={class:"d-flex gap-2"},ft=["disabled"],bt={class:"position-relative"},ht={key:0,class:"list-group list-group-flush mt-2"},xt={key:0,class:"upload-card"},yt={class:"position-relative"},kt={class:"upload-footer d-flex justify-content-between align-items-center mt-2"},wt={class:"d-flex gap-2"},Ct=["disabled"],Pt=["disabled"],Bt={key:1,class:"d-flex justify-content-between align-items-start"},Vt={class:"dropdown"},Dt={class:"text-muted",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Mt={class:"dropdown-menu dropdown-menu-end"},St=["onClick"],Nt=["onClick"],At={key:2,class:"mt-2 d-flex gap-2"},Ht={type:"button",class:"disabled btn btn-outline-secondary rounded-pill"},Kt={class:"disabled btn btn-outline-secondary rounded-pill"},$t={key:3,class:"mt-2 d-flex gap-2"},qt=["onClick"],Ft=["onClick"],Lt={class:"small-custom text-danger"},Tt={key:2,class:"m-2 float-end"},Ut={class:"modal fade",id:"pengaturanModal",tabindex:"-1","aria-labelledby":"pengaturanModalLabel","aria-hidden":"true"},jt={class:"modal-dialog modal-fullscreen-lg-down modal-lg"},Et={class:"modal-content"},It={class:"modal-header"},zt={href:"#",class:"right-top",id:"btn_modal_akun","data-bs-dismiss":"modal","aria-label":"Close"},Yt={class:"modal-body"},va=X({__name:"index",setup(Gt){lt({title:"Home"});const{isMobile:T}=rt(),A=u(!1),y=L(()=>{U()},300);u(null),u({});const c=u([]);u([]);const H=u({}),B=u({}),f=u([]),o=u({posting_new:!1,profil:!0,posting:!0,posting_sent:!0}),s=u({}),{$axiosAuth:V}=Z(),k=u({page:1});async function U(){o.value.posting=!0;const n=new FormData;for(var t in k.value)n.append(t,k.value[t]);try{let p=(await V({method:"post",url:"/unggahan",data:n})).data;c.value=p?.data,o.value.posting=!1}catch(e){console.error(e.response?.data||e.message),o.value.posting=!1}}async function j(n){if((await nt.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed){o.value.posting=!0;try{const e=await V({method:"delete",url:"/unggahan/"+n+"/delete"});y(),o.value.posting=!1}catch(e){console.error(e.response?.data||e.message),o.value.posting=!1}}}async function E(){s.value.status="menunggu",D()}async function D(){o.value.posting_new=!0,o.value.posting_sent=!0,f.value=[];const n=s.value,t=new FormData;for(var e in n)t.append(e,n[e]);try{let w=(await V({method:"post",url:"/unggahan/store",data:t})).data;if(w.status==!0){y(),s.value={},o.value.posting_new=!1,o.value.posting_sent=!1;return}y(),B.value=w.errors;const m=c.value?.data?.findIndex(b=>b.id===n.id);c.value?.data[m]&&(c.value.data[m].error=B.value),f.value[m]=B.value,o.value.posting_new=!1,o.value.posting_sent=!1}catch(p){console.error(p.response?.data||p.message),o.value.posting_sent=!1,o.value.posting_new=!1}}async function I(n){s.value={id:n.id,_method:"patch",text:n.text}}function z(){s.value={}}async function Y(n){H.value=await n}async function G(){s.value.status="menunggu",console.log(s.value),D()}async function J(n,t,e){s.value=await{id:n,status:e,index:t},D()}C(()=>k,(n,t)=>{y()},{deep:!0}),u(!1);const K=tt(),M=u({}),O=L(async()=>{M.value=await K.get("profil")?.data},300);C(()=>ot(K.get("profil")),(n,t)=>{M.value=n?.data},{deep:!0}),u(null),at(async()=>{y(),O()});async function Q(){y()}C(T,(n,t)=>{A.value=n});const g=u({max_text:200,remaining_text:200});return C(()=>s.value.text,n=>{const t=g.value.max_text||200,e=n?.length||0,p=t-e;e>t&&(s.value.text=n.slice(0,t)),g.value.remaining_text=p>=0?p:0}),(n,t)=>{const e=et("font-awesome-icon"),p=R,w=W;return l(),d("div",dt,[M.value?.peran?.guru?(l(),d("div",ct,[a("div",pt,[s.value._method!="patch"?(l(),d("div",mt,[a("div",gt,[$(a("textarea",{"onUpdate:modelValue":t[0]||(t[0]=i=>s.value.text=i),class:"upload-textarea",rows:"3",placeholder:"Apa yang sedang kamu pikirkan?"},null,512),[[q,s.value.text]]),o.value.posting_new?(l(),P(N,{key:0,class:"spinner-overlay"})):v("",!0)]),a("div",vt,[a("small",{class:h(["char-counter",{warning:g.value.remaining_text<20}])},x(g.value.max_text-g.value.remaining_text)+"/"+x(g.value.max_text),3),a("div",_t,[a("button",{type:"button",class:"upload-btn btn-send",disabled:!s.value.text||o.value.posting_new,onClick:E},[r(e,{icon:["fas","plus"],class:"me-1"}),t[3]||(t[3]=_(" Kirim ",-1))],8,ft)])])])):v("",!0),a("div",bt,[c.value?.data?.length>0?(l(),d("ul",ht,[(l(!0),d(F,null,st(c.value?.data,(i,m)=>(l(),d("li",{class:h([(s.value.id==i.id&&s.value._method=="patch",""),"list-group-item mb-3 shadow-sm rounded "]),key:m},[s.value.id==i.id&&s.value._method=="patch"?(l(),d("div",xt,[a("div",yt,[$(a("textarea",{"onUpdate:modelValue":t[1]||(t[1]=b=>s.value.text=b),class:"upload-textarea",rows:"3",placeholder:"Apa yang sedang kamu pikirkan?"},null,512),[[q,s.value.text]]),o.value.posting_new?(l(),P(N,{key:0,class:"spinner-overlay"})):v("",!0)]),a("div",kt,[a("small",{class:h(["char-counter",{warning:g.value.remaining_text<20}])},x(g.value.max_text-g.value.remaining_text)+"/"+x(g.value.max_text),3),a("div",wt,[s.value.id?(l(),d(F,{key:0},[a("button",{type:"button",class:"upload-btn btn-cancel",disabled:o.value.posting_new,onClick:z}," Batal ",8,Ct),a("button",{type:"button",class:"upload-btn btn-update",disabled:!s.value.text||o.value.posting_new,onClick:G}," Update ",8,Pt)],64)):v("",!0)])])])):(l(),d("div",Bt,[a("div",null,[a("div",null,x(i.text),1)]),a("div",Vt,[a("a",Dt,[r(e,{icon:["fas","ellipsis-vertical"]})]),a("ul",Mt,[a("li",null,[a("a",{href:"#",class:"dropdown-item",onClick:b=>I(i)},"Edit",8,St)]),a("li",null,[a("a",{href:"#",class:"dropdown-item text-danger",onClick:b=>j(i.id)},"Hapus",8,Nt)])])])])),s.value.id==i.id&&s.value._method=="patch"?(l(),d("div",At,[r(p,{class:"disabled btn btn-outline-secondary rounded-pill",to:{}},{default:S(()=>[r(e,{icon:["fas","pen-to-square"],class:"me-1"}),t[4]||(t[4]=_(" Kuis ",-1))]),_:1}),a("button",Ht,[r(e,{icon:["fas","gears"],class:"me-1"}),t[5]||(t[5]=_(" Pengaturan ",-1))]),a("button",Kt,[r(e,{icon:["far","paper-plane"],class:"text-prima4y me-1"}),t[6]||(t[6]=_(" Publikasi ",-1))])])):(l(),d("div",$t,[r(p,{class:h([f.value[m]?.kuis?"border border-danger":"","btn-outline-custom"]),to:{name:"kuis-home",params:{id:i.id},query:{tab:"pilihan_ganda"}}},{default:S(()=>[r(e,{icon:["fas","pen-to-square"],class:"me-1"}),t[7]||(t[7]=_(" Kuis ",-1))]),_:1},8,["class","to"]),A.value?(l(),P(p,{key:0,to:{name:"kuis-pengaturan",params:{id:i.id}},class:h([f.value[m]?.pengaturan?"border border-danger":"","btn-outline-custom"])},{default:S(()=>[r(e,{icon:["fas","gears"],class:"me-1"}),t[8]||(t[8]=_(" Pengaturan ",-1))]),_:1},8,["to","class"])):(l(),d("button",{key:1,type:"button",class:h([f.value[m]?.pengaturan?"border border-danger":"","btn-outline-custom"]),"data-bs-toggle":"modal","data-bs-target":"#pengaturanModal",onClick:b=>Y(i)},[r(e,{icon:["fas","gears"],class:"me-1"}),t[9]||(t[9]=_(" Pengaturan ",-1))],10,qt)),a("button",{onClick:b=>J(i.id,m,"kirim"),type:"button",class:h(["btn-outline-custom"])},[r(e,{icon:["far","paper-plane"],class:"me-1"}),t[10]||(t[10]=_(" Publikasi ",-1))],8,Ft)])),a("div",Lt,x(f.value[m]?.kuis)+", "+x(f.value[m]?.pengaturan),1)],2))),128))])):v("",!0),o.value.posting?(l(),P(N,{key:1,class:"position-center"})):v("",!0),c.value?.total>c.value?.per_page?(l(),d("div",Tt,[r(w,{modelValue:k.value.page,"onUpdate:modelValue":t[2]||(t[2]=i=>k.value.page=i),"total-items":c.value?.total?c.value.total:1,"items-per-page":c.value?.per_page?c.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):v("",!0)])])])):v("",!0),a("div",null,[r(it,{loading:o.value.posting_sent,onPageHome:Q},null,8,["loading"])]),a("div",Ut,[a("div",jt,[a("div",Et,[a("div",It,[t[11]||(t[11]=a("h5",{class:"modal-title",id:"pengaturanModalLabel"},"Pengaturan Kuis",-1)),a("a",zt,[r(e,{class:"fa-2x",icon:["fas","circle-xmark"]})])]),a("div",Yt,[r(ut,{data:H.value},null,8,["data"])])])])])])}}});export{va as default};
