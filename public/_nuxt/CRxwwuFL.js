import{_ as la}from"./BTT6KBUK.js";import{_ as ia}from"./QraDVNg7.js";import{_ as ra}from"./DBDT5h3r.js";import{_ as O}from"./BFU05jqY.js";import{u as R,r as m,s as w,e as Y,c as d,o,l as y,k as D,F as W,q as G,a,I as P,t as l,z as J,f as da,h as ca,j as ua,i as pa,x as K,y as ga,b as r,v as E,N as _a,d as ma,w as I,m as fa,S as va,n as ka}from"#entry";import{_ as ha}from"./DlAUqK2U.js";import{_ as V}from"./BbXXgusc.js";import{d as ya}from"./DoL2xymK.js";const ba={class:"container"},xa={class:"d-flex align-items-center gap-3"},wa={class:"user-name"},Ca={class:"points"},$a={class:"flex-grow-1 ms-3"},Ba={class:"progress"},Da={key:0,class:"text-center text-muted mt-4"},Sa={__name:"PeringkatNilai",props:{data:{type:Object,required:!1,default:()=>({})}},setup(A){const C=A,{$axiosAuth:f}=R(),b=m([]),v=m({...C.data}),$=m({peringkat:!1});w(()=>C.data,p=>{v.value={...p},p?.id&&S()},{deep:!0,immediate:!0});async function S(){$.value.peringkat=!0;const p=new FormData;p.append("unggahan_id",C.data?.id);try{const c=await f({method:"post",url:"/unggahan/kuis/peringkat",data:p});b.value=c.data||[],$.value.peringkat=!1}catch(c){console.error(c.response?.data||c.message),$.value.peringkat=!1}}function N(p){if(!b.value.length)return 0;const c=Math.max(...b.value.map(u=>u.total_skor||0));return c?(p/c*100).toFixed(1):0}function T(p){const c=["bg-primary","bg-success","bg-info","bg-warning","bg-danger","bg-secondary"];return c[p%c.length]}return Y(async()=>{C.data?.id&&await S()}),(p,c)=>{const u=O;return o(),d("div",ba,[(o(!0),d(W,null,G(b.value,(g,h)=>(o(),d("div",{key:h,class:"ranking-card d-flex align-items-center justify-content-between"},[a("div",xa,[a("div",{class:P(["rank-badge","rank-"+(h+1)])},l(h+1),3),a("div",null,[a("div",wa,l(g.nama),1),a("div",Ca,l(g.total_skor)+" pts",1)])]),a("div",$a,[a("div",Ba,[a("div",{class:P(["progress-bar",T(h)]),role:"progressbar",style:J({width:N(g.total_skor)+"%"})},null,6)])])]))),128)),b.value?.length?y("",!0):(o(),d("div",Da)),$.value.peringkat?(o(),D(u,{key:1,class:"position-center"})):y("",!0)])}}},Na=ha(Sa,[["__scopeId","data-v-f30f34da"]]),za={class:"position-relative"},Ia={class:"search-bar mb-1 mb-md-3 position-relative"},Pa={key:0,class:"mb-3"},ja={class:"card",style:{"min-height":"300px"}},qa={class:"card-body position-relative"},Fa={class:"position-center"},Aa={key:1,class:"mb-3"},Ta={key:0},Ma={class:"card shadow-sm"},La={class:"card-body"},Ua={class:"d-flex justify-content-between align-items-start"},Va={class:"row align-items-start"},Wa={class:"col-auto"},Ha=["onClick"],Ka=["onClick"],Ea={class:"col"},Oa=["onClick"],Ra={class:"text-muted small"},Ya={class:"text-muted small"},Ga={class:"mb-2"},Ja={class:"quiz-meta d-none d-md-block"},Qa={class:"quiz-mapel"},Xa={class:"quiz-meta d-md-none d-block"},Za={class:"quiz-mapel text-center"},ae={class:"text-center"},ee={class:"row"},te={class:"col-sm-12 p-2"},se={class:"notebook position-relative"},ne={class:"d-flex justify-content-between align-items-center mt-3"},oe={class:"d-flex gap-3 flex-wrap text-secondary position-relative"},le=["onClick"],ie={class:"ms-1"},re=["onClick"],de={class:"ms-1"},ce=["onClick"],ue={class:"ms-1"},pe={key:0,class:"position-absolute top-0 end-0 m-4"},ge={class:"dropdown"},_e={role:"button","data-bs-toggle":"dropdown"},me={class:"dropdown-menu shadow-sm"},fe=["onClick"],ve=["onClick"],ke=["onClick"],he=["onClick"],ye={key:2,class:"m-2 float-end"},be={class:"modal fade",id:"peringkat","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},xe={class:"modal-dialog modal-dialog-scrollable"},we={class:"modal-content"},Ce={class:"modal-header position-relative text-center"},$e={type:"button",class:"btn right-top","data-bs-dismiss":"modal","aria-label":"Close"},Be={class:"modal-body"},De=da({__name:"PostingsShow",props:{loading:{type:Boolean,default:!1}},emits:["pageHome"],setup(A,{emit:C}){const f=ya(()=>{q()},300),b=A,v=ca(),$=ua(),S=pa(),N=S.params.user,T=m(1),p=m({page:1}),c=m({}),u=m({data:[]}),g=m({}),h=m(""),{$axiosAuth:j}=R(),_=m({cari:"",page:1});N?h.value="/profil/"+N+"/unggahan":h.value="/unggahan/terkirim";async function q(){g.value.unggahan=!0;try{let e=(await j({method:"post",url:h.value,params:_.value})).data;e.status==!0?u.value=e?.data:c.value=e,g.value.unggahan=!1}catch(s){console.log(s.response?.data),g.value.unggahan=!1}}async function Q(s,e){g.value.unggahan=!0;const n=new FormData;n.append("id",s);try{let B=(await j({method:"post",url:"/unggahan/draf/back",data:n})).data;q(),ea(),g.value.unggahan=!1}catch(i){console.error(i.response?.data||i.message),g.value.posting_sent=!1,g.value.unggahan=!1}}async function X(s){if((await va.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const n=await j({method:"delete",url:"/unggahan/"+s+"/delete"});q()}catch(n){console.error(n.response?.data||n.message)}}async function M(s,e,n){let i=u.value.data[s];i.loading=!0;const B=new FormData;B.append("unggahan_id",e),B.append("reaksi",n);try{let x=(await j({method:"post",url:"/unggahan/reaksi/store",data:B})).data;i.tidak_suka_count=x.tidak_suka,i.suka_count=x.suka,i.reaksi_ku=x.reaksi,i.mark=x.mark,i.loading=!1,n=="mark"&&v.set("tanda",x.mark)}catch(z){console.error(z.response?.data||z.message),i.loading=!1}}async function L(s){await ka({name:"profil",params:{user:s}})}function Z(){_.value.cari=""}Y(async()=>{let s=S.query.page;s&&(T.value=Number(s)||1),f()}),w(()=>v.get("refresh-page"),(s,e)=>{s!=e&&f()}),w(()=>b.loading,(s,e)=>{s!==e&&f()}),w(_,(s,e)=>{p.value.page=s.page,$.push({query:{page:s.page}}),f()},{deep:!0}),w(()=>v.get("tanda"),(s,e)=>{s!==e&&f()});const U=m(!1);w(()=>v.get("cari_unggahan"),s=>{s?_.value.cari!==s&&(U.value=!0,_.value.cari=s,f()):_.value.cari=null}),w(()=>_.value.cari,(s,e)=>{s!==e&&(U.value?U.value=!1:(v.get("cari_unggahan")&&v.clear("cari_unggahan"),v.set("cari",!0),f()))});const aa=C;function ea(){aa("pageHome")}const ta=async s=>{if(navigator.share)try{await navigator.share({url:s})}catch(e){console.log("User batal share",e)}else window.open("https://wa.me/?text="+window.location.origin+s,"_blank")},H=m({});function sa(s){H.value=s}return(s,e)=>{const n=E("font-awesome-icon"),i=la,B=ia,z=ra,x=E("FontAwesomeIcon"),na=Na,oa=_a("lazy");return o(),d("div",za,[a("div",Ia,[K(a("input",{type:"text",onKeyup:e[0]||(e[0]=t=>q()),"onUpdate:modelValue":e[1]||(e[1]=t=>_.value.cari=t),placeholder:"Cari Unggahan ID / Nama"},null,544),[[ga,_.value.cari]]),_.value.cari?(o(),d("button",{key:0,onClick:e[2]||(e[2]=t=>Z()),type:"button",class:"btn right-center-20"},[r(n,{icon:["fas","circle-xmark"],class:"text-secondary"})])):y("",!0)]),c.value.message?(o(),d("div",Pa,[a("div",ja,[a("div",qa,[a("div",Fa,[a("div",null,[r(n,{icon:["fas","users-slash"],class:"fa-4x text-secondary"})]),a("div",null,l(c.value.message),1)])])])])):(o(),d("div",Aa,[a("div",null,[u.value.data.length<1?(o(),d("div",Ta,[...e[4]||(e[4]=[a("div",{class:"card",style:{"min-height":"300px"}},[a("div",{class:"card-body d-flex justify-content-center align-items-center"},[a("div",{class:"text-center"}," Belum ada unggahan ")])],-1)])])):(o(!0),d(W,{key:1},G(u.value.data,(t,F)=>(o(),d("div",{class:"list-group-item position-relative mb-3",key:F},[a("div",Ma,[a("div",La,[a("div",Ua,[a("div",Va,[a("div",Wa,[t.profil.image_show?K((o(),d("img",{key:0,class:"profil-img avatar-50 lazy-img",onClick:k=>L(t.profil.username)},null,8,Ha)),[[oa,t.profil.image_show]]):(o(),d("div",{key:1,style:J({backgroundColor:t.profil.color}),class:"avatar-50 profile-img",onClick:k=>L(t.profil.username)},l(t.profil.nama_inisial),13,Ka))]),a("div",Ea,[a("div",{class:"fw-bold cursor-pointer",onClick:k=>L(t.profil.username)},l(t.profil.nama_lengkap),9,Oa),a("div",Ra," ID: "+l(t.id_ref),1),a("div",Ya,l(t.created_at_for_humans),1)]),e[5]||(e[5]=a("div",{class:"text-muted small"},null,-1))]),e[6]||(e[6]=a("div",{class:"col-sm-6 text-muted small",style:{"margin-top":"-10px","padding-top":"-10px !important"}},null,-1))]),e[10]||(e[10]=a("hr",{class:"my-2"},null,-1)),a("div",Ga,[a("div",Ja,[a("span",Qa,l(t.kuis?.mata_pelajaran),1),ma(" ⏰ "+l(t.kuis?.mulai_formated_2)+" WIB – "+l(t.kuis?.tutup_formated_2)+" WIB ",1)]),a("div",Xa,[a("div",Za,l(t.kuis?.mata_pelajaran),1),a("div",ae," ⏰ "+l(t.kuis?.mulai_formated_2)+" WIB – "+l(t.kuis?.tutup_formated_2)+" WIB ",1)]),a("div",ee,[a("div",te,[a("div",se,[a("div",null,l(t.text||""),1)])])])]),a("div",ne,[a("div",null,[a("div",null,[t?.kuis?.status_aksi=="tutup"?(o(),D(i,{key:0,to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.is}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:I(()=>[...e[7]||(e[7]=[a("img",{src:V,width:"20",height:"20"},null,-1),a("span",null," Tutup",-1)])]),_:1},8,["to"])):t?.kuis?.status_aksi=="berlangsung"?(o(),D(i,{key:1,to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.is}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:I(()=>[...e[8]||(e[8]=[a("img",{src:V,width:"20",height:"20"},null,-1),a("span",null," Berlangsung",-1)])]),_:1},8,["to"])):(o(),D(i,{key:2,to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.is}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:I(()=>[...e[9]||(e[9]=[a("img",{src:V,width:"20",height:"20"},null,-1),a("span",null," Belum dimulai",-1)])]),_:1},8,["to"]))])]),a("div",oe,[a("button",{class:"btn p-0 text-secondary",onClick:k=>M(F,t.id,"suka"),title:"Suka"},[r(n,{icon:["fas","heart"],class:P({"text-danger":t.reaksi_ku==="suka"})},null,8,["class"]),a("span",ie,l(t.suka_count),1)],8,le),a("button",{class:"btn p-0 text-secondary",onClick:k=>M(F,t.id,"tidak suka"),title:"Tidak Suka"},[r(n,{icon:["fas","heart-crack"],class:P({"text-danger":t.reaksi_ku==="tidak suka"})},null,8,["class"]),a("span",de,l(t.tidak_suka_count),1)],8,re),a("button",{class:"btn p-0 text-secondary",onClick:k=>M(F,t.id,"mark"),title:"Favorit"},[r(n,{icon:["fas","bookmark"],class:P({"text-danger":t.mark})},null,8,["class"])],8,ce),r(i,{to:`/${t.profil.username}/unggahan/${t.id}`,class:"text-secondary text-decoration-none small",title:"Komentar"},{default:I(()=>[r(n,{icon:["fas","comments"]}),a("span",ue,l(t.tanggapan_all_count??0),1)]),_:2},1032,["to"]),t.loading?(o(),D(B,{key:0,class:"position-center"})):y("",!0)])])]),fa(N)?y("",!0):(o(),d("div",pe,[a("div",ge,[a("a",_e,[r(n,{icon:["fas","ellipsis-vertical"],class:"text-secondary"})]),a("ul",me,[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>ta(`/${t.profil.username}/unggahan/${t.id}`)},[r(n,{icon:["fas","share-nodes"]}),e[11]||(e[11]=a("span",null,"Bagikan",-1))],8,fe)]),a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>sa(t),"data-bs-toggle":"modal","data-bs-target":"#peringkat"},[r(n,{icon:["fas","ranking-star"]}),e[12]||(e[12]=a("span",null,"Peringkat",-1))],8,ve)]),t.miliku?(o(),d(W,{key:0},[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>Q(t.id,t.text)},[r(n,{icon:["fas","file-pen"]}),e[13]||(e[13]=a("span",null,"Kembalikan ke Draf",-1))],8,ke)]),a("li",null,[r(i,{to:{name:"kuis-laporan",params:{id:t.id}},class:"dropdown-item d-flex align-items-center gap-2"},{default:I(()=>[r(n,{icon:["fas","chart-line"]}),e[14]||(e[14]=a("span",null,"Laporan",-1))]),_:1},8,["to"])]),a("li",null,[a("a",{href:"#",class:"dropdown-item text-danger d-flex align-items-center gap-2",onClick:k=>X(t.id)},[r(n,{icon:["fas","trash"]}),e[15]||(e[15]=a("span",null,"Hapus",-1))],8,he)])],64)):y("",!0)])])]))])]))),128))])])),u.value.total>u.value.per_page?(o(),d("div",ye,[r(z,{modelValue:_.value.page,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value.page=t),"total-items":u.value.total?u.value.total:1,"items-per-page":u.value.per_page?u.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):y("",!0),g.value.unggahan?(o(),D(O,{key:3,class:"position-center"})):y("",!0),a("div",be,[a("div",xe,[a("div",we,[a("div",Ce,[e[16]||(e[16]=a("h2",{class:"text-center mb-4"},"🏆 Leaderboard",-1)),a("button",$e,[r(x,{icon:["fa","circle-xmark"],class:"fa-2x"})])]),a("div",Be,[r(na,{data:H.value},null,8,["data"])])])])])])}}}),Ae=Object.assign(De,{__name:"PostingsShow"});export{Ae as P};
