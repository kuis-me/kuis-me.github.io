import{_ as Q}from"./BwT3rymJ.js";import{_ as q}from"./DTCu01cd.js";import{f as H,r as c,s as J,ai as X,c as r,o as s,l as _,a as t,b as p,t as b,L as K,I as Z,w as D,k as I,m as z,h as ee,i as te,u as ae,e as oe,z as A,v as O,F as le,q as se,d as P,x as j,y as G,aj as ne,K as ie}from"#entry";import{R as re,S as x}from"./BntJLfB0.js";import{_ as ue}from"./DlAUqK2U.js";import{_ as W}from"./BFU05jqY.js";import{d as de}from"./DoL2xymK.js";const ce={class:"position-relative"},me={key:0,class:"left-top",style:{"z-index":"1000"}},pe={style:{color:"red"}},ve={id:"my_form"},fe={key:0},_e={key:1},be={class:"flex justify-center"},ge=H({__name:"Crop",props:{options:{type:Object,default:()=>({})}},emits:["kirim"],setup(T,{emit:w}){const V=T,v=c({...V.options});J(()=>V.options,i=>{v.value={...i}},{deep:!0,immediate:!0});const a=c(0),k=c(null),B=c(),f=c(""),h=c(!1),o=c(!1),m=X({dataURL:"",blobURL:""}),C=i=>{const l=i.target?.files?.[0];l&&F(l)},S=async()=>{if(!x)return;const i=await x.getDataURL(),l=await x.getBlob();l&&(a.value=(l.size/1024).toFixed(2),(l.size/1024).toFixed(2)>500)||(m.dataURL=i||"",m.blobURL=l?URL.createObjectURL(l):"",document.getElementById("btnModalPhoto")?.click(),g(m.dataURL,m.blobURL),e())},R=c(!1),U=c(""),L=()=>{R.value=!0},$=()=>{R.value=!1},E=i=>{i.preventDefault(),R.value=!1;const l=i.dataTransfer?.files?.[0];if(l){if(k.value){const y=new DataTransfer;y.items.add(l),k.value.files=y.files}F(l)}},F=i=>{f.value=URL.createObjectURL(i),m.dataURL="",m.blobURL="",h.value=!0,o.value=!0;const l=new FileReader;l.onload=()=>{m.dataURL=l.result},l.readAsDataURL(i)},N=()=>{x&&x.clear()},n=()=>{x&&x.reset()},e=()=>{document.getElementById("my_form").reset(),h.value=!1,f.value="",document.getElementById("btn-close-modal")?.click(),o.value=!1},d=w;function g(i,l){d("kirim",i,l)}return(i,l)=>{const y=q;return s(),r("div",ce,[h.value?(s(),r("div",me,[t("div",null,[t("button",{class:"btn btn-success me-2",onClick:S},"Crop"),t("button",{class:"btn btn-info me-2",onClick:n},"Reset"),t("button",{class:"btn btn-warning me-2",onClick:N},"Clear"),t("button",{class:"btn btn-danger me-2",onClick:e},"Batal")]),t("span",pe," Maksimal 500 KB , gambar anda "+b(a.value+" KB"),1)])):_("",!0),t("form",ve,[h.value?_("",!0):(s(),r("div",{key:0,class:Z(["drop-area",{dragging:R.value}]),onDragover:K(L,["prevent"]),onDragleave:K($,["prevent"]),onDrop:K(E,["prevent"])},[U.value?(s(),r("p",_e,"File dipilih: "+b(U.value),1)):(s(),r("p",fe,"Drag & drop file di sini atau klik untuk pilih")),t("div",be,[h.value?_("",!0):(s(),r("input",{key:0,type:"file",id:"input_file",ref_key:"fileInput",ref:k,class:"text-center",onChange:C},null,544))])],34))]),p(y,null,{default:D(()=>[o.value?(s(),I(z(re),{key:0,ref_key:"cropperRef",ref:B,img:f.value,boxStyle:{width:"100%",height:"auto",backgroundColor:"#f0f0f0",margin:"0px",padding:"0px"},options:{viewMode:1,dragMode:"crop",aspectRatio:v.value?.aspectRatio!==void 0?v.value.aspectRatio:NaN},style:{flex:"1"}},null,8,["img","options"])):_("",!0)]),_:1})])}}}),ye=Object.assign(ue(ge,[["__scopeId","data-v-c80fc9a7"]]),{__name:"Crop"}),ke={key:0,class:"mb-4"},he={class:"progress"},xe=["aria-valuenow"],we={class:"d-flex justify-content-center mb-3 position-relative"},Ce={key:0,class:"rounded-circle border shadow-sm lazy-img",style:{width:"100px",height:"100px","object-fit":"cover"}},Re={key:2,href:"#",class:"position-absolute bottom-0 end-0","data-bs-toggle":"modal","data-bs-target":"#modalCrop"},Le={class:"text-center mb-3"},ze={class:"mb-0 fw-bold"},Be={class:"text-muted"},Ue={class:"text-center mb-4"},De={class:"fst-italic text-muted",style:{"min-height":"50px"}},Ie={class:"d-flex justify-content-around border-top pt-3 text-muted small text-center mb-3"},Se={class:"border-top pt-3"},$e={class:"text-muted"},Fe={class:"text-muted text-end"},Me=["onClick"],Pe={class:"text-end mt-3"},je={class:"modal fade",id:"modalCrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1"},Ve={class:"modal-dialog modal-xl"},Ee={class:"modal-content position-relative"},Ne={type:"button",class:"btn right-top","data-bs-dismiss":"modal"},Ke={class:"modal-body",style:{"min-height":"200px"}},Oe={href:"#",class:"d-none right-center",id:"btn-close-modal","data-bs-dismiss":"modal","aria-label":"Close"},Te={class:"modal fade",id:"modalEdit",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ae={class:"modal-dialog modal-lg"},Ge={class:"modal-content"},We={class:"modal-body bg-light position-relative",style:{"padding-top":"50px !important"}},qe={type:"button",id:"modal_profil_close",class:"btn right-top","data-bs-dismiss":"modal","aria-label":"Close"},He={class:"mb-3"},Je=H({__name:"Profil",setup(T){const w=ee(),v=te().params.user,a=c({}),k=c(null),B=c(null),f=c(!1),h=[{name:"HP",value:"hp"},{name:"Tanggal lahir",value:"tanggal_lahir"},{name:"Domisili",value:"alamat"},{name:"Profesi",value:"pekerjaan"},{name:"Kelas",value:"kelas"},{name:"Jurusan",value:"jurusan"},{name:"Institusi",value:"institusi"}];c("");const o=c({name:"",value:""}),m=c({profil:!1}),C=c({}),{$axiosAuth:S}=ae(),R=de(async()=>{const n=await w.get("profil");n?.status&&!v?a.value=n.data:U()},300);J(()=>z(w.get("profil")),(n,e)=>{a.value=n.data},{deep:!0});async function U(){m.value.profil=!0,v?B.value=`profil/${v}/show`:B.value="/profil";try{const e=(await S({method:"post",url:B.value})).data;console.log(e),v?w.set("getProfil",e):w.set("profil",e),a.value=e?.data??{},m.value.profil=!1}catch(n){console.log(n.response.data)}}async function L(n,e,d){o.value.label=n,o.value.name=e,o.value.value=d}async function $(){if(m.value.profil=!0,C.value={},o.value.name=="image"&&o.value.file_size>.5){C.value={image:["Gambar maksimal 0.5 MB"]},window.scrollTo({top:0,behavior:"smooth"}),m.value.profil=!1;return}const n=new FormData;n.append(o.value.name,o.value.value);try{const d=(await S({method:"post",url:"/profil/store",data:n})).data;U(),document.getElementById("modal_profil_close")?.click(),m.value.profil=!1}catch(e){console.error(e.response?.data||e.message),m.value.profil=!1}}oe(async()=>{R()});async function E(n,e){C.value={};let d=F(n)?.fileSizeInMB;if(d>.5){C.value={image:["Gambar maksimal 0.5 MB"]},window.scrollTo({top:0,behavior:"smooth"});return}o.value.file_size=d,k.value=e,await L("","image",n),await $()}function F(n,e=10){let d=n.split(",")[1]||n,g=d.length,i=d.endsWith("==")?2:d.endsWith("=")?1:0,l=g*.75-i,y=(l/1024).toFixed(2),M=(l/(1024*1024)).toFixed(2);return{base64Length:g,fileSizeInBytes:l,fileSizeInKB:y,fileSizeInMB:M,valid:M<=e}}function N(n){o.value.name==="hp"&&(o.value.value=n.target.value.replace(/\D/g,""))}return(n,e)=>{const d=O("FontAwesomeIcon"),g=Q,i=O("font-awesome-icon"),l=O("FlatPickr"),y=q,M=ie("lazy");return s(),r("div",null,[a.value.pencapaian<100?(s(),r("div",ke,[e[9]||(e[9]=t("p",{class:"mb-1 small"},"Perkembangan akun Anda",-1)),t("div",he,[t("div",{class:"progress-bar",role:"progressbar",style:A({width:a.value.pencapaian+"%"}),"aria-valuenow":a.value.pencapaian,"aria-valuemin":"0","aria-valuemax":"100"},b(a.value.pencapaian)+"% ",13,xe)])])):_("",!0),t("div",we,[a.value.nama_lengkap?_("",!0):(s(),I(W,{key:0,class:"position-center"})),p(g,{to:"/home/profil",class:"d-inline-block position-relative"},{default:D(()=>[k.value||a.value.image_show?j((s(),r("img",Ce,null,512)),[[M,k.value||a.value.image_show]]):(s(),r("div",{key:1,class:"rounded-circle text-white d-flex align-items-center justify-content-center",style:A({width:"100px",height:"100px",fontSize:"2rem",background:a.value.color})},b(a.value.nama_inisial),5)),!z(v)&&f.value?(s(),r("a",Re,[p(d,{icon:["fa","pencil"],class:"text-primary bg-white rounded-circle p-1"})])):_("",!0)]),_:1})]),t("div",Le,[t("h5",ze,b(a.value.nama_lengkap),1),t("small",Be,b(a.value.email),1),!z(v)&&f.value?(s(),r("a",{key:0,href:"#",class:"ms-2",onClick:e[0]||(e[0]=u=>L("Nama Lengkap","nama_lengkap",a.value.nama_lengkap)),"data-bs-toggle":"modal","data-bs-target":"#modalEdit"},[p(d,{icon:["fa","pencil"],class:"text-secondary"})])):_("",!0)]),t("div",Ue,[t("p",De,b(a.value.semboyan||"Belum ada semboyan."),1),!z(v)&&f.value?(s(),r("a",{key:0,href:"#",class:"ms-2",onClick:e[1]||(e[1]=u=>L("Semboyan","semboyan",a.value.semboyan)),"data-bs-toggle":"modal","data-bs-target":"#modalEdit"},[p(d,{icon:["fa","pencil"],class:"text-secondary"})])):_("",!0)]),t("div",Ie,[t("div",null,[p(g,{to:{name:"mengikuti"},class:"text-decoration-none text-reset"},{default:D(()=>[t("strong",null,b(a.value.mengikuti_acc_count),1),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=P("Mengikuti ",-1))]),_:1})]),t("div",null,[p(g,{to:{name:"pengikut"},class:"text-decoration-none text-reset"},{default:D(()=>[t("strong",null,b(a.value.pengikut_acc_count),1),e[12]||(e[12]=t("br",null,null,-1)),e[13]||(e[13]=P("Pengikut ",-1))]),_:1})])]),t("div",Se,[(s(),r(le,null,se(h,(u,Y)=>t("div",{key:Y,class:"mb-2 d-flex justify-content-between align-items-center"},[t("div",$e,b(u.name)+":",1),t("div",Fe,[P(b(a.value[u.value])+" ",1),!z(v)&&f.value?(s(),r("a",{key:0,href:"#",class:"ms-2",onClick:Ye=>L(u.name,u.value,u.value=="tanggal_lahir"?a.value.tanggal_lahir_iso:a.value[u.value]),"data-bs-toggle":"modal","data-bs-target":"#modalEdit"},[p(d,{icon:["fa","pencil"],class:"text-secondary"})],8,Me)):_("",!0)])])),64))]),t("div",Pe,[f.value?(s(),r("button",{key:1,onClick:e[3]||(e[3]=u=>f.value=!1),type:"button",class:"btn btn-sm btn-outline-danger rounded-pill"},[e[14]||(e[14]=P(" Selesai ",-1)),p(d,{icon:["fas","circle-xmark"]})])):(s(),r("button",{key:0,onClick:e[2]||(e[2]=u=>f.value=!0),type:"button",class:"btn btn-sm btn-outline-secondary rounded-pill"}," Ubah "))]),t("div",je,[t("div",Ve,[t("div",Ee,[t("button",Ne,[p(i,{icon:["fas","circle-xmark"],class:"fa-2x",style:{"z-index":"1000"}})]),t("div",Ke,[t("a",Oe,[f.value?(s(),I(i,{key:0,icon:["fas","circle-xmark"],class:"fa-2x",style:{"z-index":"1000"}})):_("",!0)]),p(ye,{onKirim:E,options:{aspectRatio:1}})])])])]),t("div",Te,[t("div",Ae,[t("div",Ge,[t("div",We,[t("button",qe,[p(i,{class:"fa-2x",icon:["fas","circle-xmark"]})]),t("form",null,[t("div",He,[o.value.name==="tanggal_lahir"?(s(),I(y,{key:0},{default:D(()=>[p(l,{ref:"pickerRef",modelValue:o.value.value,"onUpdate:modelValue":e[4]||(e[4]=u=>o.value.value=u),config:{dateFormat:"Y-m-d"},placeholder:"Pilih tanggal",class:"form-control"},null,8,["modelValue"])]),_:1})):o.value.name==="hp"?j((s(),r("input",{key:1,onInput:N,type:"text",pattern:"\\d{9,15}","onUpdate:modelValue":e[5]||(e[5]=u=>o.value.value=u),class:"form-control form-control-sm"},null,544)),[[G,o.value.value]]):o.value.name==="pekerjaan"?j((s(),r("select",{key:2,type:"text","onUpdate:modelValue":e[6]||(e[6]=u=>o.value.value=u),class:"form-control form-control-sm"},[...e[15]||(e[15]=[t("option",{value:"",disabled:"",selected:""},"Pilih opsi",-1),t("option",{value:"Guru"},"Guru",-1),t("option",{value:"Siswa"},"Siswa",-1)])],512)),[[ne,o.value.value]]):j((s(),r("input",{key:3,type:"text","onUpdate:modelValue":e[7]||(e[7]=u=>o.value.value=u),class:"form-control form-control-sm"},null,512)),[[G,o.value.value]])]),t("div",null,[t("button",{type:"button",class:"btn btn-sm btn-primary rounded-pill",onClick:e[8]||(e[8]=u=>$())},"Ganti")])]),m.value.profil?(s(),I(W,{key:0,class:"position-center"})):_("",!0)])])])])])}}}),lt=Object.assign(Je,{__name:"Profil"});export{lt as P};
