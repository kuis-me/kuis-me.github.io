import{_ as qa}from"./CikNTp_N.js";import{D as La,S as Fa,a as Pa,_ as Ba}from"./D-Tgru-p.js";import{_ as Va}from"./DSPHs38f.js";import{_ as Ua}from"./BFU05jqY.js";import{f as $a,u as Ia,h as Aa,r as s,L as Ma,G as N,M as oa,e as za,c as i,o,l as c,a as t,k as W,b as g,I as y,d as U,t as b,w as Ta,z as Ja,ak as Ga,p as Na,A as Wa,F as K,q as ia,B as Ka,S as Ha,n as Ra,m as Xa}from"#entry";import{C as Ya}from"./DSGyqoFQ.js";import{u as Qa}from"./CUA_6ykz.js";import{u as Oa}from"./C-MlBdbB.js";import{d as Za}from"./DoL2xymK.js";import"./BzLCLO6P.js";import"./QraDVNg7.js";import"./DlAUqK2U.js";const ae={key:0},ee={class:"navbar fixed-top"},te={class:"py-4 position-relative mt-3"},ne={key:1,class:"camera-container"},se={class:"camera-wrapper"},le={key:2,class:"row justify-content-center mb-5"},oe={class:"col-12 col-xl-7"},ie={class:"tab-content",id:"quizTabContent"},ue={class:"p-3"},re={class:"p-3"},ce={class:"quiz-tabs fixed-bottom bg-white border-top py-2 px-3 shadow-sm",id:"bottom-nav"},de={class:"d-flex justify-content-between align-items-center flex-wrap"},me={class:"btn-group",role:"group","aria-label":"Basic example"},pe={class:"nav-left",id:"navLeft"},ve={class:"quiz-meta mb-3"},fe={class:"quiz-mapel text-center"},_e={style:{height:"100%","overflow-y":"auto"}},ge={key:0,class:"mb-3"},be={class:"kotak-wrapper"},ke=["onClick","disabled"],we={key:1},he={class:"kotak-wrapper"},ye=["onClick","disabled"],xe={key:1,class:"modal fade show",tabindex:"-1",style:{display:"block","background-color":"rgba(0,0,0,0.5)"}},je={class:"modal-dialog modal-dialog-centered"},De={class:"modal-content"},Ee={class:"modal-header"},Ce={class:"modal-body position-relative text-center"},Se={key:0},qe={key:0,class:"mb-2"},Le={key:1,class:"mb-3"},Fe={key:1,class:"mb-3 text-success fw-bold"},Pe={class:"d-flex justify-content-center gap-2"},Be={key:1,class:"d-flex justify-content-center align-items-center",style:{"min-height":"100px"}},Ye=$a({__name:"answer",setup(Ve){Qa({title:"Menjawab Kuis "}),Oa();const{$axiosAuth:E}=Ia(),H=Aa(),m=Ma(),x=Ka(),R=s({}),X=s({}),k=m.params.id,C=s({run:!1,mulai:"",selesai:""});s(1);const ua=s("pilihan_ganda"),$=s(!1),Y=s({});s({});const Q=s({}),I=s([]),A=s({}),v=s({}),f=s([]),j=s(!1),d=s({mulai:!0,camera:!1,selesai:!1}),D=s({fullscreen:!1,status:!0}),L=s(0),ra=s(!1),M=s(""),_=s({page_pg:null,page_ur:null,page_list:1}),w=s({pra_mulai:!1,mulai:!1,selesai:!1,tutup:!1}),O=s({waktu_mulai:"",waktu_selesai:""}),S=s(m.query.tab||"pilihan_ganda"),Z=s(!1);s(!1);const z=s({nama:"",image_show:"",nama_inisial:"",color:"",izin_balas:!1,list:[]});async function ca(){d.value.mulai=!0;const e=new FormData;e.append("unggahan_id",k);try{let l=(await E({method:"post",url:"/unggahan/kuis/answer/check",data:e})).data;if(R.value=l,console.log(l),!l.buka){x.push({name:"kuis-persiapan",params:{id:k}});return}let p=l.data,r=await p?.jawab;Y.value=r;let q=r?.status;z.value.jawab_id=r?.id,z.value.list=r?r.pesan:[];let n=p?.kuis,G=n?.jawab,Ue=n?.mulai,$e=n?.akhir,V=r?.status;if(M.value=n?.swafoto_aksi,Q.value=n,$.value=G,n?.layar_penuh?D.value.status=!0:D.value.status=!1,V=="tutup"?w.value.tutup=!0:V=="selesai"&&(w.value.selesai=!0),V=="selesai"||V=="tutup"){d.value.mulai=!1,ra.value=!0;return}d.value.mulai=!1,L.value=p?.jawab?.swafoto,O.value=await{waktu_mulai:n.waktu_mulai_iso,waktu_selesai:n.waktu_selesai_realisasi_iso};let Sa=n.pg_total_soal,Ie=n.ur_total_soal;m.query.tab||x.replace({query:{...m.query,tab:Sa>0?"pilihan_ganda":"uraian"}})}catch(a){console.error(a.response?.data||a.message),d.value.mulai=!1}}const h=s({}),F=s(!1);async function aa(){d.value.selesai=!0,F.value=!0;const e=new FormData;e.append("unggahan_id",k);try{let l=(await E({method:"post",url:"/unggahan/kuis/answer/cek-soal",data:e})).data;h.value=l}catch(a){console.error(a.response?.data||a.message)}d.value.selesai=!1}async function da(){D.value.status=!1;const e=new FormData;e.append("unggahan_id",k);try{const a=await E({method:"post",url:"/unggahan/kuis/answer/selesai",data:e});T()}catch(a){console.error(a.response?.data||a.message)}}async function ma(e){const a=new FormData;a.append("unggahan_id",k),a.append("pelanggaran",e.keterangan),a.append("jumlah",e.jumlah);try{const l=await E({method:"post",url:"/unggahan/kuis/pelanggaran/store",data:a})}catch(l){console.error(l.response?.data||l.message)}}N(()=>m.query.tab,e=>{e&&(S.value=e)});function pa(){const e=C.value.mulai,a=C.value.selesai;w.value={pra_mulai:!1,mulai:!1,selesai:!1,tutup:!1},e!=="00:00:00"?w.value.pra_mulai=!0:a!=="00:00:00"?w.value.mulai=!0:e==="00:00:00"&&a==="00:00:00"&&$.value?(w.value.selesai=!0,T()):e==="00:00:00"&&a==="00:00:00"&&!$.value&&(w.value.tutup=!0,T())}function va(e){e.stopPropagation(),document.getElementById("navLeft").classList.toggle("open")}function fa(){document.getElementById("navLeft")?.classList.remove("open")}document.addEventListener("click",function(e){if(window.innerWidth>768)return;const a=document.querySelector(".nav-left");if(!a)return;["nav-left","nav-toggle","nav-btn"].some(p=>e.target.closest("."+p))||a.classList.remove("open")});async function _a(e){I.value=e;let a=L.value;e.some(u=>u.nomor==a)&&M.value!="off"&&(j.value=!0)}async function ga(e){A.value=e;let a=L.value;e.some(u=>u.nomor==a)&&M.value!="off"&&(j.value=!0,Ha.fire({title:"Silahkan foto diri untuk melanjutkan!",icon:"warning",draggable:!0}))}async function ba(e){v.value=e}async function ka(e){f.value=e}let P=!1;async function wa(e){if(P||!j.value)return;P=!0,d.value.camera=!0;const a=new FormData;a.append("image",e.base64),a.append("unggahan_id",k);try{let u=(await E({method:"post",url:"/unggahan/kuis/answer/swafoto",data:a})).data,p=u?.status,r=u?.nomor;d.value.camera=!1,p==!0?(j.value=!1,L.value=r):P=!1}catch(l){console.error(l.response?.data||l.message),d.value.camera=!1}finally{d.value.camera=!1,P=!1}}const ha=s(0);async function ya(e){C.value=e,ha.value=parseInt(e.selesai.split(":")[1],10),pa()}async function T(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():console.log("Bukan dalam mode fullscreen"),x.push({name:"kuis-persiapan",params:{id:k}})}function ea(e){e=="selesai"&&aa()}s({clientX:0,clientY:0,movementX:0,movementY:0}),s(null);function xa(){document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}oa(()=>{xa()}),N(_,(e,a)=>{x.replace({query:{...m.query,page_list:e.page_list}})},{deep:!0});function ta(e){ua.value=e,Ra({query:{...m.query,tab:e}})}function ja(e){let a=Math.ceil(e/v.value.per_page);x.replace({query:{...m.query,page_pg:a,nomor_pg:e,tab:"pilihan_ganda"}})}function Da(e){let a=Math.ceil(e/f.value.per_page);x.replace({query:{...m.query,page_ur:a,nomor_ur:e,tab:"uraian"}})}const Ea=Za(async()=>{X.value=await H.get("profil")?.data},300);N(()=>Xa(H.get("profil")),(e,a)=>{X.value=e?.data},{deep:!0});function B(e,a,l){let u=a?.find(q=>q.nomor==l),r=e?.jenis_soal=="adaptif";return{jawab:!!u?.jawab,disabled:u?.jawab||u?.nomor?!1:!!r}}function Ca(e){const[a,l,u]=e.split(":").map(Number);return a*60+l+Math.floor(u/60)}let J=null;async function na(){if(!("wakeLock"in navigator)){console.log("⚠️ Browser tidak mendukung Wake Lock API");return}try{J=await navigator.wakeLock.request("screen"),console.log("✅ Wake lock aktif"),J.addEventListener("release",()=>{console.log("⚠️ Wake lock dilepas")})}catch(e){console.error("❌ Gagal aktifkan wake lock:",e)}}const sa=document.documentElement;function la(){sa&&D.value.status&&(document.fullscreenElement||sa.requestFullscreen().catch(e=>{console.warn("Gagal masuk fullscreen:",e)}))}return za(async()=>{m.query.page_list&&(_.value.page_list=Number(m.query.page_list)),await Ea(),await ca(),Z.value=!0,document.addEventListener("click",na,{once:!0}),document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&J===null&&await na()}),document.addEventListener("click",la)}),oa(()=>{document.removeEventListener("click",la)}),(e,a)=>{const l=qa,u=Ba,p=Va,r=Ua,q=Wa("font-awesome-icon");return o(),i("div",null,[R.value.buka?(o(),i("div",ae,[t("nav",ee,[t("div",{class:y(["right-top",[Ca(C.value?.selesai)<5?"border-blink-red":""]])},[U(b(C.value.selesai)+" ",1),t("button",{class:"btn btn-sm btn-secondary",onClick:a[0]||(a[0]=n=>aa())},"Selesai")],2)]),Z.value?(o(),W(l,{key:0,data:z.value},null,8,["data"])):c("",!0),g(p,null,{default:Ta(()=>[g(u,{waktu:O.value,onTime_left:ya},null,8,["waktu"])]),_:1}),t("div",te,[D.value.status?(o(),W(La,{key:0,data:Y.value,fullscreen:D.value.fullscreen,onPelanggaran:ma},null,8,["data","fullscreen"])):c("",!0),j.value?(o(),i("div",ne,[t("div",se,[g(Ya,{onCapture:wa}),d.value.camera?(o(),W(r,{key:0,class:"position-center",style:{"z-index":"1200"}})):c("",!0)])])):c("",!0),j.value?c("",!0):(o(),i("div",le,[t("div",oe,[t("div",ie,[t("div",{class:y({"tab-pane":!0,fade:!0,"show active":S.value==="pilihan_ganda"}),id:"pilihan_ganda",role:"tabpanel","aria-labelledby":"tab-pg"},[t("div",ue,[g(Fa,{onJawab:_a,onData:ba,onInput:ea,modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=n=>_.value=n)},null,8,["modelValue"])])],2),t("div",{class:y({"tab-pane":!0,fade:!0,"show active":S.value==="uraian"}),id:"uraian",role:"tabpanel","aria-labelledby":"tab-uraian"},[t("div",re,[g(Pa,{onJawab:ga,onData:ka,onInput:ea,modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=n=>_.value=n)},null,8,["modelValue"])])],2)])])])),t("div",ce,[t("div",de,[t("button",{type:"button",class:"btn",onClick:a[3]||(a[3]=n=>va(n))}," ▶️ JAWAB "),t("div",null,[t("div",me,[v.value.jumlah_soal>0?(o(),i("button",{key:0,onClick:a[4]||(a[4]=n=>ta("pilihan_ganda")),class:y([S.value=="pilihan_ganda"?"active ":"","nav-link mx-2"]),id:"tab-pg","data-bs-toggle":"tab","data-bs-target":"#pilihan_ganda",type:"button",role:"tab","aria-controls":"soal_pilihan_ganda","aria-selected":"true"},[t("strong",null," Pilihan G. ("+b(v.value.jumlah_soal)+") ",1)],2)):c("",!0),f.value.jumlah_soal>0?(o(),i("button",{key:1,onClick:a[5]||(a[5]=n=>ta("uraian")),class:y([S.value=="uraian"||v.value.jumlah_soal==0?"active":"","nav-link mx-2"]),id:"tab-uraian","data-bs-toggle":"tab","data-bs-target":"#uraian",type:"button",role:"tab","aria-controls":"soal_uraian","aria-selected":"false"},[t("strong",null,[t("b",null," Uraian ("+b(f.value.jumlah_soal)+") ",1)])],2)):c("",!0)])]),t("div",null,[a[12]||(a[12]=U(" List ",-1)),Ja(t("select",{"onUpdate:modelValue":a[6]||(a[6]=n=>_.value.page_list=n),style:{"border-radius":"5px"}},[...a[11]||(a[11]=[Na('<option value="1"> 1</option><option value="5"> 5</option><option value="10"> 10</option><option value="50"> 50</option><option value="100"> 100</option>',5)])],512),[[Ga,_.value.page_list]])])])])]),t("div",pe,[t("button",{type:"button",class:"btn right-top",onClick:a[7]||(a[7]=n=>fa())},[g(q,{class:"fa-2x",icon:["fas","circle-xmark"]})]),t("div",ve,[t("div",fe,[t("strong",null,b(Q.value?.mata_pelajaran),1)])]),t("div",_e,[v.value.jumlah_soal>0?(o(),i("div",ge,[a[13]||(a[13]=t("label",null,"Pilihan Ganda",-1)),t("div",be,[(o(!0),i(K,null,ia(v.value.jumlah_soal,n=>(o(),i("div",null,[t("button",{type:"button",onClick:G=>ja(n),class:y([B(v.value,I.value,n)?.jawab?"btn btn-primary":"","kotak-kecil"]),disabled:B(v.value,I.value,n)?.disabled},b(n),11,ke)]))),256))])])):c("",!0),f.value.jumlah_soal>0?(o(),i("div",we,[a[14]||(a[14]=t("label",null,"Uraian",-1)),t("div",he,[(o(!0),i(K,null,ia(f.value.jumlah_soal,n=>(o(),i("div",null,[t("button",{type:"button",onClick:G=>Da(n),class:y([B(f.value,A.value,n)?.jawab?"btn btn-primary":"","kotak-kecil"]),disabled:B(f.value,A.value,n)?.disabled},b(n),11,ye)]))),256))])])):c("",!0)])]),F.value?(o(),i("div",xe,[t("div",je,[t("div",De,[t("div",Ee,[g(q,{class:"fa-2x text-warning me-2",icon:["fas","triangle-exclamation"]}),a[15]||(a[15]=t("h5",{class:"modal-title w-100 text-center mb-0"},"Apakah Anda yakin?",-1)),t("button",{type:"button",class:"btn-close",onClick:a[8]||(a[8]=n=>F.value=!1)})]),t("div",Ce,[d.value.selesai?(o(),i("div",Be,[g(r)])):(o(),i(K,{key:0},[h.value?.pilihan_ganda?.belum_dijawab||h.value?.uraian?.belum_dijawab?(o(),i("div",Se,[h.value?.pilihan_ganda?.status?(o(),i("div",qe,[a[16]||(a[16]=U(" Soal pilihan ganda belum dijawab: ",-1)),t("strong",null,b(h.value?.pilihan_ganda?.belum_dijawab),1)])):c("",!0),h.value?.uraian?.status?(o(),i("div",Le,[a[17]||(a[17]=U(" Soal uraian belum dijawab: ",-1)),t("strong",null,b(h.value?.uraian?.belum_dijawab),1)])):c("",!0)])):(o(),i("div",Fe," Sempurna! Semua soal telah dikerjakan 🎉 ")),t("div",Pe,[t("button",{class:"btn btn-success btn-sm",onClick:a[9]||(a[9]=n=>da())},"Selesai"),t("button",{class:"btn btn-danger btn-sm",onClick:a[10]||(a[10]=n=>F.value=!1)},"Batal")])],64))])])])])):c("",!0)])):c("",!0)])}}});export{Ye as default};
