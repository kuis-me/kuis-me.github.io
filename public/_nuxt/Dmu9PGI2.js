import{_ as Q}from"./BTT6KBUK.js";import{_ as R}from"./DBDT5h3r.js";import{f as W,r,u as X,s as w,h as Z,e as ee,c as d,o as i,l as g,a as t,x as K,k as C,y as $,I as f,t as x,b as u,d as v,v as te,F as q,q as ae,w as D,S as se,m as ne}from"#entry";import{u as oe}from"./CUA_6ykz.js";import{_ as M}from"./BFU05jqY.js";/* empty css        */import{P as le}from"./BS73xJ6E.js";import"./Dda1HtW4.js";import"./C31_JZqf.js";import"./BLmUUPHe.js";import{P as ie}from"./Dpt2eAqU.js";import{u as ue}from"./C-MlBdbB.js";import{d as F}from"./DoL2xymK.js";/* empty css        */import"./DlAUqK2U.js";import"./QraDVNg7.js";import"./BbXXgusc.js";import"./DTCu01cd.js";import"./cmuNVbBL.js";import"./B1oisLxj.js";import"./W0NU78oz.js";import"./DsmCZfJr.js";const re={class:"container-fluid px-0"},de={key:0,class:"card mb-1 mb-md-3"},ce={class:"card-body"},pe={key:0,class:"upload-card"},me={class:"position-relative"},ge={class:"upload-footer d-flex justify-content-between align-items-center mt-2"},ve={class:"d-flex gap-2"},_e=["disabled"],fe={class:"position-relative"},be={key:0,class:"list-group list-group-flush mt-2"},he={key:0,class:"upload-card"},xe={class:"position-relative"},ye={class:"upload-footer d-flex justify-content-between align-items-center mt-2"},ke={class:"d-flex gap-2"},we=["disabled"],Ce=["disabled"],Pe={key:1,class:"d-flex justify-content-between align-items-start"},Be={class:"dropdown"},Ve={class:"text-muted",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},De={class:"dropdown-menu dropdown-menu-end"},Me=["onClick"],Se=["onClick"],Ne={key:2,class:"mt-2 d-flex gap-2"},Ae={type:"button",class:"disabled btn btn-outline-secondary rounded-pill"},He={class:"disabled btn btn-outline-secondary rounded-pill"},Ke={key:3,class:"mt-2 d-flex gap-2"},$e=["onClick"],qe=["onClick"],Fe={key:2,class:"m-2 float-end"},Le={class:"modal fade",id:"pengaturanModal",tabindex:"-1","aria-labelledby":"pengaturanModalLabel","aria-hidden":"true"},Te={class:"modal-dialog modal-fullscreen-lg-down modal-lg"},Ue={class:"modal-content"},je={class:"modal-header"},Ee={href:"#",class:"right-top",id:"btn_modal_akun","data-bs-dismiss":"modal","aria-label":"Close"},Ie={class:"modal-body"},mt=W({__name:"index",setup(ze){oe({title:"Home"});const{isMobile:L}=ue(),S=r(!1),b=F(()=>{T()},300);r(null),r({});const p=r([]);r([]);const N=r({}),A=r({}),o=r({posting_new:!1,profil:!0,posting:!0,posting_sent:!0}),s=r({}),{$axiosAuth:P}=X(),h=r({page:1});async function T(){o.value.posting=!0;const n=new FormData;for(var e in h.value)n.append(e,h.value[e]);try{let c=(await P({method:"post",url:"/unggahan",data:n})).data;p.value=c?.data,o.value.posting=!1}catch(a){console.error(a.response?.data||a.message),o.value.posting=!1}}async function U(n){if((await se.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed){o.value.posting=!0;try{const a=await P({method:"delete",url:"/unggahan/"+n+"/delete"});b(),o.value.posting=!1}catch(a){console.error(a.response?.data||a.message),o.value.posting=!1}}}async function j(){s.value.status="menunggu",B()}async function B(){o.value.posting_new=!0,o.value.posting_sent=!0;const n=s.value,e=new FormData;for(var a in n)e.append(a,n[a]);try{let y=(await P({method:"post",url:"/unggahan/store",data:e})).data;if(y.status==!0){b(),s.value={},o.value.posting_new=!1,o.value.posting_sent=!1;return}b(),A.value=y.errors;const k=p.value.findIndex(_=>_.id===n.id);p.value[k].error=A.value,o.value.posting_new=!1,o.value.posting_sent=!1}catch(c){console.error(c.response?.data||c.message),o.value.posting_sent=!1,o.value.posting_new=!1}}async function E(n){s.value={id:n.id,_method:"patch",text:n.text}}function I(){s.value={}}async function z(n){N.value=await n}async function Y(){s.value.status="menunggu",console.log(s.value),B()}async function G(n,e,a){s.value=await{id:n,status:a,index:e},B()}w(()=>h,(n,e)=>{b()},{deep:!0}),r(!1);const H=Z(),V=r({}),J=F(async()=>{V.value=await H.get("profil")?.data},300);w(()=>ne(H.get("profil")),(n,e)=>{V.value=n?.data},{deep:!0}),r(null),ee(async()=>{b(),J()});async function O(){b()}w(L,(n,e)=>{S.value=n});const m=r({max_text:200,remaining_text:200});return w(()=>s.value.text,n=>{const e=m.value.max_text||200,a=n?.length||0,c=e-a;a>e&&(s.value.text=n.slice(0,e)),m.value.remaining_text=c>=0?c:0}),(n,e)=>{const a=te("font-awesome-icon"),c=Q,y=R;return i(),d("div",re,[V.value?.peran?.guru?(i(),d("div",de,[t("div",ce,[!s.value.id&&s.value._method!="patch"?(i(),d("div",pe,[t("div",me,[K(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.text=l),class:"upload-textarea",rows:"3",placeholder:"Apa yang sedang kamu pikirkan?"},null,512),[[$,s.value.text]]),o.value.posting_new?(i(),C(M,{key:0,class:"spinner-overlay"})):g("",!0)]),t("div",ge,[t("small",{class:f(["char-counter",{warning:m.value.remaining_text<20}])},x(m.value.max_text-m.value.remaining_text)+"/"+x(m.value.max_text),3),t("div",ve,[t("button",{type:"button",class:"upload-btn btn-send",disabled:!s.value.text||o.value.posting_new,onClick:j},[u(a,{icon:["fas","plus"],class:"me-1"}),e[3]||(e[3]=v(" Kirim ",-1))],8,_e)])])])):g("",!0),t("div",fe,[p.value?.data?.length>0?(i(),d("ul",be,[(i(!0),d(q,null,ae(p.value?.data,(l,k)=>(i(),d("li",{class:f([(s.value.id==l.id&&s.value._method=="patch",""),"list-group-item mb-3 shadow-sm rounded "]),key:k},[s.value.id==l.id&&s.value._method=="patch"?(i(),d("div",he,[t("div",xe,[K(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=_=>s.value.text=_),class:"upload-textarea",rows:"3",placeholder:"Apa yang sedang kamu pikirkan?"},null,512),[[$,s.value.text]]),o.value.posting_new?(i(),C(M,{key:0,class:"spinner-overlay"})):g("",!0)]),t("div",ye,[t("small",{class:f(["char-counter",{warning:m.value.remaining_text<20}])},x(m.value.max_text-m.value.remaining_text)+"/"+x(m.value.max_text),3),t("div",ke,[s.value.id?(i(),d(q,{key:0},[t("button",{type:"button",class:"upload-btn btn-cancel",disabled:o.value.posting_new,onClick:I}," Batal ",8,we),t("button",{type:"button",class:"upload-btn btn-update",disabled:!s.value.text||o.value.posting_new,onClick:Y}," Update ",8,Ce)],64)):g("",!0)])])])):(i(),d("div",Pe,[t("div",null,[t("div",null,x(l.text),1)]),t("div",Be,[t("a",Ve,[u(a,{icon:["fas","ellipsis-vertical"]})]),t("ul",De,[t("li",null,[t("a",{href:"#",class:"dropdown-item",onClick:_=>E(l)},"Edit",8,Me)]),t("li",null,[t("a",{href:"#",class:"dropdown-item text-danger",onClick:_=>U(l.id)},"Hapus",8,Se)])])])])),s.value.id==l.id&&s.value._method=="patch"?(i(),d("div",Ne,[u(c,{class:"disabled btn btn-outline-secondary rounded-pill",to:{}},{default:D(()=>[u(a,{icon:["fas","pen-to-square"],class:"me-1"}),e[4]||(e[4]=v(" Kuis ",-1))]),_:1}),t("button",Ae,[u(a,{icon:["fas","gears"],class:"me-1"}),e[5]||(e[5]=v(" Pengaturan ",-1))]),t("button",He,[u(a,{icon:["far","paper-plane"],class:"text-prima4y me-1"}),e[6]||(e[6]=v(" Publikasi ",-1))])])):(i(),d("div",Ke,[u(c,{class:f([l.error.kuis?"border border-danger":"","btn-outline-custom"]),to:{name:"kuis-home",params:{id:l.id},query:{tab:"pilihan_ganda"}}},{default:D(()=>[u(a,{icon:["fas","pen-to-square"],class:"me-1"}),e[7]||(e[7]=v(" Kuis ",-1))]),_:1},8,["class","to"]),S.value?(i(),C(c,{key:0,to:{name:"kuis-pengaturan",params:{id:l.id}},class:f([l.error.pengaturan?"border border-danger":"","btn-outline-custom"])},{default:D(()=>[u(a,{icon:["fas","gears"],class:"me-1"}),e[8]||(e[8]=v(" Pengaturan ",-1))]),_:1},8,["to","class"])):(i(),d("button",{key:1,type:"button",class:f([l.error.pengaturan?"border border-danger":"","btn-outline-custom"]),"data-bs-toggle":"modal","data-bs-target":"#pengaturanModal",onClick:_=>z(l)},[u(a,{icon:["fas","gears"],class:"me-1"}),e[9]||(e[9]=v(" Pengaturan ",-1))],10,$e)),t("button",{onClick:_=>G(l.id,k,"kirim"),type:"button",class:f(["btn-outline-custom"])},[u(a,{icon:["far","paper-plane"],class:"me-1"}),e[10]||(e[10]=v(" Publikasi ",-1))],8,qe)]))],2))),128))])):g("",!0),o.value.posting?(i(),C(M,{key:1,class:"position-center"})):g("",!0),p.value?.total>p.value?.per_page?(i(),d("div",Fe,[u(y,{modelValue:h.value.page,"onUpdate:modelValue":e[2]||(e[2]=l=>h.value.page=l),"total-items":p.value?.total?p.value.total:1,"items-per-page":p.value?.per_page?p.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):g("",!0)])])])):g("",!0),t("div",null,[u(le,{loading:o.value.posting_sent,onPageHome:O},null,8,["loading"])]),t("div",Le,[t("div",Te,[t("div",Ue,[t("div",je,[e[11]||(e[11]=t("h5",{class:"modal-title",id:"pengaturanModalLabel"},"Pengaturan Kuis",-1)),t("a",Ee,[u(a,{class:"fa-2x",icon:["fas","circle-xmark"]})])]),t("div",Ie,[u(ie,{data:N.value},null,8,["data"])])])])])])}}});export{mt as default};
