import{_ as la}from"./CwQB-XB4.js";import{_ as ia}from"./QraDVNg7.js";import{_ as ra}from"./DCdpMFYG.js";import{_ as R}from"./BFU05jqY.js";import{u as G,r as m,G as w,e as W,c as d,o,l as y,k as S,F as V,q as Y,a,I as F,t as l,H as J,f as da,h as ca,j as ua,i as pa,z as E,C as ga,b as r,A as O,N as _a,w as j,m as ma,S as fa,n as va}from"#entry";import{_ as ka}from"./DlAUqK2U.js";import{_ as U}from"./DmRUS9VP.js";import{d as ha}from"./DoL2xymK.js";const ya={class:"container"},ba={class:"d-flex align-items-center gap-3"},xa={class:"user-name"},wa={class:"points"},Ca={class:"flex-grow-1 ms-3"},$a={class:"progress"},Da={key:0,class:"text-center text-muted mt-4"},Sa={__name:"PeringkatNilai",props:{data:{type:Object,required:!1,default:()=>({})}},setup(M){const C=M,{$axiosAuth:f}=G(),b=m([]),v=m({...C.data}),$=m({peringkat:!1});w(()=>C.data,p=>{v.value={...p},p?.id&&B()},{deep:!0,immediate:!0});async function B(){$.value.peringkat=!0;const p=new FormData;p.append("unggahan_id",C.data?.id);try{const c=await f({method:"post",url:"/unggahan/kuis/peringkat",data:p});b.value=c.data||[],$.value.peringkat=!1}catch(c){console.error(c.response?.data||c.message),$.value.peringkat=!1}}function N(p){if(!b.value.length)return 0;const c=Math.max(...b.value.map(u=>u.total_skor||0));return c?(p/c*100).toFixed(1):0}function T(p){const c=["bg-primary","bg-success","bg-info","bg-warning","bg-danger","bg-secondary"];return c[p%c.length]}return W(async()=>{C.data?.id&&await B()}),(p,c)=>{const u=R;return o(),d("div",ya,[(o(!0),d(V,null,Y(b.value,(g,h)=>(o(),d("div",{key:h,class:"ranking-card d-flex align-items-center justify-content-between"},[a("div",ba,[a("div",{class:F(["rank-badge","rank-"+(h+1)])},l(h+1),3),a("div",null,[a("div",xa,l(g.nama),1),a("div",wa,l(g.total_skor)+" pts",1)])]),a("div",Ca,[a("div",$a,[a("div",{class:F(["progress-bar",T(h)]),role:"progressbar",style:J({width:N(g.total_skor)+"%"})},null,6)])])]))),128)),b.value?.length?y("",!0):(o(),d("div",Da)),$.value.peringkat?(o(),S(u,{key:1,class:"position-center"})):y("",!0)])}}},Ba=ka(Sa,[["__scopeId","data-v-f30f34da"]]),Na={class:"position-relative"},Pa={class:"search-bar mb-1 mb-md-3 position-relative"},ja={key:0,class:"mb-3"},Fa={class:"card",style:{"min-height":"300px"}},Aa={class:"card-body position-relative"},za={class:"position-center"},Ia={key:1,class:"mb-3"},Ma={key:0},Ta={class:"card shadow-sm"},qa={class:"card-body"},Ha={class:"d-flex justify-content-between align-items-start"},La={class:"row align-items-start"},Ua={class:"col-auto"},Va=["onClick"],Ka=["onClick"],Ea={class:"col"},Oa=["onClick"],Ra={class:"small-custom text-start"},Ga={class:"small-custom text-start"},Wa={class:"mb-2 small-"},Ya={class:"text-end d-none d-md-block"},Ja={class:"small-custom mapel-kuis"},Qa={class:"small-custom"},Xa={class:"d-md-none d-block"},Za={class:"small-custom text-center mapel-kuis"},as={class:"small-custom text-center"},ss={class:"row"},ts={class:"col-sm-12 p-2"},es={class:"position-relative"},ns={class:"d-flex justify-content-between align-items-center mt-3"},os={class:"d-flex gap-3 flex-wrap text-secondary position-relative"},ls=["onClick"],is={class:"ms-1"},rs=["onClick"],ds={class:"ms-1"},cs=["onClick"],us={class:"ms-1"},ps={key:0,class:"position-absolute top-0 end-0 m-4"},gs={class:"dropdown"},_s={role:"button","data-bs-toggle":"dropdown"},ms={class:"dropdown-menu shadow-sm"},fs=["onClick"],vs=["onClick"],ks=["onClick"],hs=["onClick"],ys={key:2,class:"m-2 float-end"},bs={class:"modal fade",id:"peringkat","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},xs={class:"modal-dialog modal-dialog-scrollable"},ws={class:"modal-content"},Cs={class:"modal-header position-relative text-center"},$s={type:"button",class:"btn right-top","data-bs-dismiss":"modal","aria-label":"Close"},Ds={class:"modal-body"},Ss=da({__name:"PostingsShow",props:{loading:{type:Boolean,default:!1}},emits:["pageHome"],setup(M,{emit:C}){const f=ha(()=>{z()},300),b=M,v=ca(),$=ua(),B=pa(),N=B.params.user,T=m(1),p=m({page:1}),c=m({}),u=m({data:[]}),g=m({}),h=m(""),{$axiosAuth:A}=G(),_=m({cari:"",page:1});N?h.value="/profil/"+N+"/unggahan":h.value="/unggahan/terkirim";async function z(){g.value.unggahan=!0;try{let s=(await A({method:"post",url:h.value,params:_.value})).data;s.status==!0?u.value=s?.data:c.value=s,g.value.unggahan=!1}catch(e){console.log(e.response?.data),g.value.unggahan=!1}}async function Q(e,s){g.value.unggahan=!0;const n=new FormData;n.append("id",e);try{let D=(await A({method:"post",url:"/unggahan/draf/back",data:n})).data;z(),sa(),g.value.unggahan=!1}catch(i){console.error(i.response?.data||i.message),g.value.posting_sent=!1,g.value.unggahan=!1}}async function X(e){if((await fa.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const n=await A({method:"delete",url:"/unggahan/"+e+"/delete"});z()}catch(n){console.error(n.response?.data||n.message)}}async function q(e,s,n){let i=u.value.data[e];i.loading=!0;const D=new FormData;D.append("unggahan_id",s),D.append("reaksi",n);try{let x=(await A({method:"post",url:"/unggahan/reaksi/store",data:D})).data;i.tidak_suka_count=x.tidak_suka,i.suka_count=x.suka,i.reaksi_ku=x.reaksi,i.mark=x.mark,i.loading=!1,n=="mark"&&v.set("tanda",x.mark)}catch(P){console.error(P.response?.data||P.message),i.loading=!1}}async function H(e){await va({name:"profil",params:{user:e}})}function Z(){_.value.cari=""}W(async()=>{let e=B.query.page;e&&(T.value=Number(e)||1),f()}),w(()=>v.get("refresh-page"),(e,s)=>{e!=s&&f()}),w(()=>b.loading,(e,s)=>{e!==s&&f()}),w(_,(e,s)=>{p.value.page=e.page,$.push({query:{page:e.page}}),f()},{deep:!0}),w(()=>v.get("tanda"),(e,s)=>{e!==s&&f()});const L=m(!1);w(()=>v.get("cari_unggahan"),e=>{e?_.value.cari!==e&&(L.value=!0,_.value.cari=e,f()):_.value.cari=null}),w(()=>_.value.cari,(e,s)=>{e!==s&&(L.value?L.value=!1:(v.get("cari_unggahan")&&v.clear("cari_unggahan"),v.set("cari",!0),f()))});const aa=C;function sa(){aa("pageHome")}const ta=async e=>{if(navigator.share)try{await navigator.share({url:e})}catch(s){console.log("User batal share",s)}else window.open("https://wa.me/?text="+window.location.origin+e,"_blank")},K=m({});function ea(e){K.value=e}return(e,s)=>{const n=O("font-awesome-icon"),i=la,D=ia,P=ra,x=O("FontAwesomeIcon"),na=Ba,oa=_a("lazy");return o(),d("div",Na,[a("div",Pa,[E(a("input",{type:"text",onKeyup:s[0]||(s[0]=t=>z()),"onUpdate:modelValue":s[1]||(s[1]=t=>_.value.cari=t),placeholder:"Cari Unggahan ID / Nama"},null,544),[[ga,_.value.cari]]),_.value.cari?(o(),d("button",{key:0,onClick:s[2]||(s[2]=t=>Z()),type:"button",class:"btn right-center-20"},[r(n,{icon:["fas","circle-xmark"],class:"text-secondary"})])):y("",!0)]),c.value.message?(o(),d("div",ja,[a("div",Fa,[a("div",Aa,[a("div",za,[a("div",null,[r(n,{icon:["fas","users-slash"],class:"fa-4x text-secondary"})]),a("div",null,l(c.value.message),1)])])])])):(o(),d("div",Ia,[a("div",null,[u.value.data.length<1?(o(),d("div",Ma,[...s[4]||(s[4]=[a("div",{class:"card",style:{"min-height":"300px"}},[a("div",{class:"card-body d-flex justify-content-center align-items-center"},[a("div",{class:"text-center"}," Belum ada unggahan ")])],-1)])])):(o(!0),d(V,{key:1},Y(u.value.data,(t,I)=>(o(),d("div",{class:"list-group-item position-relative mb-3",key:I},[a("div",Ta,[a("div",qa,[a("div",Ha,[a("div",La,[a("div",Ua,[t.profil.image_show?E((o(),d("img",{key:0,class:"profil-img avatar-50 lazy-img",onClick:k=>H(t.profil.username)},null,8,Va)),[[oa,t.profil.image_show]]):(o(),d("div",{key:1,style:J({backgroundColor:t.profil.color}),class:"avatar-50 profile-img",onClick:k=>H(t.profil.username)},l(t.profil.nama_inisial),13,Ka))]),a("div",Ea,[a("div",{class:"fw-bold cursor-pointer",onClick:k=>H(t.profil.username)},l(t.profil.nama_lengkap),9,Oa),a("div",Ra,"ID: "+l(t.id_ref),1),a("div",Ga,l(t.created_at_for_humans),1)]),s[5]||(s[5]=a("div",{class:"text-muted small"},null,-1))]),s[6]||(s[6]=a("div",{class:"col-sm-6 text-muted small",style:{"margin-top":"-10px","padding-top":"-10px !important"}},null,-1))]),s[10]||(s[10]=a("hr",{class:"my-2"},null,-1)),a("div",Wa,[a("div",Ya,[a("span",Ja,l(t.kuis?.mata_pelajaran),1),a("span",Qa," ⏰ "+l(t.kuis?.mulai_formated_2)+" – "+l(t.kuis?.tutup_formated_2),1)]),a("div",Xa,[a("div",Za,l(t.kuis?.mata_pelajaran),1),a("div",as," ⏰ "+l(t.kuis?.mulai_formated_2)+" – "+l(t.kuis?.tutup_formated_2),1)]),a("div",ss,[a("div",ts,[a("div",es,[a("div",null,l(t.text||""),1)])])])]),a("div",ns,[a("div",null,[a("div",null,[t?.kuis?.status_aksi=="tutup"?(o(),S(i,{key:0,to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.id}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:j(()=>[...s[7]||(s[7]=[a("img",{src:U,width:"20",height:"20"},null,-1),a("span",null," Tutup",-1)])]),_:1},8,["to"])):t?.kuis?.status_aksi=="berlangsung"?(o(),S(i,{key:1,to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.id}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:j(()=>[...s[8]||(s[8]=[a("img",{src:U,width:"20",height:"20"},null,-1),a("span",null," Berlangsung",-1)])]),_:1},8,["to"])):(o(),S(i,{key:2,to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.id}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:j(()=>[...s[9]||(s[9]=[a("img",{src:U,width:"20",height:"20"},null,-1),a("span",null," Belum dimulai",-1)])]),_:1},8,["to"]))])]),a("div",os,[a("button",{class:"btn p-0 text-secondary",onClick:k=>q(I,t.id,"suka"),title:"Suka"},[r(n,{icon:["fas","heart"],class:F({"text-danger":t.reaksi_ku==="suka"})},null,8,["class"]),a("span",is,l(t.suka_count),1)],8,ls),a("button",{class:"btn p-0 text-secondary",onClick:k=>q(I,t.id,"tidak suka"),title:"Tidak Suka"},[r(n,{icon:["fas","heart-crack"],class:F({"text-danger":t.reaksi_ku==="tidak suka"})},null,8,["class"]),a("span",ds,l(t.tidak_suka_count),1)],8,rs),a("button",{class:"btn p-0 text-secondary",onClick:k=>q(I,t.id,"mark"),title:"Favorit"},[r(n,{icon:["fas","bookmark"],class:F({"text-danger":t.mark})},null,8,["class"])],8,cs),r(i,{to:{name:"tanggapan",params:{user:t.profil.username,id:t.id}},class:"text-secondary text-decoration-none small",title:"Komentar"},{default:j(()=>[r(n,{icon:["fas","comments"]}),a("span",us,l(t.tanggapan_all_count??0),1)]),_:2},1032,["to"]),t.loading?(o(),S(D,{key:0,class:"position-center"})):y("",!0)])])]),ma(N)?y("",!0):(o(),d("div",ps,[a("div",gs,[a("a",_s,[r(n,{icon:["fas","ellipsis-vertical"],class:"text-secondary"})]),a("ul",ms,[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>ta(`/${t.profil.username}/unggahan/${t.id}`)},[r(n,{icon:["fas","share-nodes"]}),s[11]||(s[11]=a("span",null,"Bagikan",-1))],8,fs)]),a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>ea(t),"data-bs-toggle":"modal","data-bs-target":"#peringkat"},[r(n,{icon:["fas","ranking-star"]}),s[12]||(s[12]=a("span",null,"Peringkat",-1))],8,vs)]),t.miliku?(o(),d(V,{key:0},[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:k=>Q(t.id,t.text)},[r(n,{icon:["fas","file-pen"]}),s[13]||(s[13]=a("span",null,"Kembalikan ke Draf",-1))],8,ks)]),a("li",null,[r(i,{to:{name:"kuis-laporan",params:{id:t.id}},class:"dropdown-item d-flex align-items-center gap-2"},{default:j(()=>[r(n,{icon:["fas","chart-line"]}),s[14]||(s[14]=a("span",null,"Laporan",-1))]),_:1},8,["to"])]),a("li",null,[a("a",{href:"#",class:"dropdown-item text-danger d-flex align-items-center gap-2",onClick:k=>X(t.id)},[r(n,{icon:["fas","trash"]}),s[15]||(s[15]=a("span",null,"Hapus",-1))],8,hs)])],64)):y("",!0)])])]))])]))),128))])])),u.value.total>u.value.per_page?(o(),d("div",ys,[r(P,{modelValue:_.value.page,"onUpdate:modelValue":s[3]||(s[3]=t=>_.value.page=t),"total-items":u.value.total?u.value.total:1,"items-per-page":u.value.per_page?u.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):y("",!0),g.value.unggahan?(o(),S(R,{key:3,class:"position-center"})):y("",!0),a("div",bs,[a("div",xs,[a("div",ws,[a("div",Cs,[s[16]||(s[16]=a("h2",{class:"text-center mb-4"},"🏆 Leaderboard",-1)),a("button",$s,[r(x,{icon:["fa","circle-xmark"],class:"fa-2x"})])]),a("div",Ds,[r(na,{data:K.value},null,8,["data"])])])])])])}}}),Ms=Object.assign(Ss,{__name:"PostingsShow"});export{Ms as P};
