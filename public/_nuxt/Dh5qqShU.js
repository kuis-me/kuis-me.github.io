import{_ as X}from"./CwQB-XB4.js";import{_ as Z}from"./DCdpMFYG.js";import{f as ee,r as u,u as te,G as C,h as ae,e as se,c as r,o as l,l as _,a as t,z as q,k as P,C as F,I as b,t as y,b as d,d as f,A as ne,F as S,q as L,w as A,S as oe,m as le}from"#entry";import{u as ie}from"./CUA_6ykz.js";import{_ as N}from"./BFU05jqY.js";/* empty css        */import{P as ue}from"./guNrlRrX.js";import"./DeDina9t.js";import"./KJ3nDwG6.js";import"./BjpAK5g7.js";import{P as re}from"./Tyvxwlya.js";import{u as de}from"./C-MlBdbB.js";import{d as T}from"./DoL2xymK.js";/* empty css        */import"./DlAUqK2U.js";import"./QraDVNg7.js";import"./DmRUS9VP.js";import"./DSPHs38f.js";import"./CSUp8RW0.js";import"./CkhwbRmL.js";import"./B5Pd6NfA.js";import"./DsmCZfJr.js";const ce={class:"container-fluid px-0"},pe={key:0,class:"card mb-1 mb-md-3"},me={class:"card-body"},ge={key:0,class:"upload-card"},ve={class:"position-relative"},_e={class:"upload-footer d-flex justify-content-between align-items-center mt-2"},fe={class:"d-flex gap-2"},be=["disabled"],he={class:"position-relative"},xe={key:0,class:"list-group list-group-flush mt-2"},ye={key:0,class:"upload-card"},ke={class:"position-relative"},we={class:"upload-footer d-flex justify-content-between align-items-center mt-2"},Ce={class:"d-flex gap-2"},Pe=["disabled"],Be=["disabled"],Ve={key:1,class:"d-flex justify-content-between align-items-start"},De={class:"dropdown"},Me={class:"text-muted",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Se={class:"dropdown-menu dropdown-menu-end"},Ae=["onClick"],Ne=["onClick"],He={key:2,class:"mt-2 d-flex gap-2"},Ke={type:"button",class:"disabled btn btn-outline-secondary rounded-pill"},$e={class:"disabled btn btn-outline-secondary rounded-pill"},qe={key:3,class:"mt-2 d-flex gap-2"},Fe=["onClick"],Le=["onClick"],Te={key:2,class:"m-2 float-end"},Ue={class:"modal fade",id:"pengaturanModal",tabindex:"-1","aria-labelledby":"pengaturanModalLabel","aria-hidden":"true"},je={class:"modal-dialog modal-fullscreen-lg-down modal-lg"},Ee={class:"modal-content"},ze={class:"modal-header"},Ie={href:"#",class:"right-top",id:"btn_modal_akun","data-bs-dismiss":"modal","aria-label":"Close"},Ge={class:"modal-body"},vt=ee({__name:"index",setup(Ye){ie({title:"Home"});const{isMobile:U}=de(),H=u(!1),h=T(()=>{j()},300);u(null),u({});const c=u([]);u([]);const K=u({}),B=u({}),x=u([]),o=u({posting_new:!1,profil:!0,posting:!0,posting_sent:!0}),s=u({}),{$axiosAuth:V}=te(),k=u({page:1});async function j(){o.value.posting=!0;const n=new FormData;for(var e in k.value)n.append(e,k.value[e]);try{let p=(await V({method:"post",url:"/unggahan",data:n})).data;c.value=p?.data,o.value.posting=!1}catch(a){console.error(a.response?.data||a.message),o.value.posting=!1}}async function E(n){if((await oe.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed){o.value.posting=!0;try{const a=await V({method:"delete",url:"/unggahan/"+n+"/delete"});h(),o.value.posting=!1}catch(a){console.error(a.response?.data||a.message),o.value.posting=!1}}}async function z(){s.value.status="menunggu",D()}async function D(){o.value.posting_new=!0,o.value.posting_sent=!0,x.value=[];const n=s.value,e=new FormData;for(var a in n)e.append(a,n[a]);try{let w=(await V({method:"post",url:"/unggahan/store",data:e})).data;if(w.status==!0){h(),s.value={},o.value.posting_new=!1,o.value.posting_sent=!1;return}h(),B.value=w.errors;const g=c.value?.data?.findIndex(v=>v.id===n.id);c.value?.data[g]&&(c.value.data[g].error=B.value),x.value[g]=B.value,o.value.posting_new=!1,o.value.posting_sent=!1}catch(p){console.error(p.response?.data||p.message),o.value.posting_sent=!1,o.value.posting_new=!1}}async function I(n){s.value={id:n.id,_method:"patch",text:n.text}}function G(){s.value={}}async function Y(n){K.value=await n}async function J(){s.value.status="menunggu",console.log(s.value),D()}async function O(n,e,a){s.value=await{id:n,status:a,index:e},D()}C(()=>k,(n,e)=>{h()},{deep:!0}),u(!1);const $=ae(),M=u({}),Q=T(async()=>{M.value=await $.get("profil")?.data},300);C(()=>le($.get("profil")),(n,e)=>{M.value=n?.data},{deep:!0}),u(null),se(async()=>{h(),Q()});async function R(){h()}C(U,(n,e)=>{H.value=n});const m=u({max_text:200,remaining_text:200});return C(()=>s.value.text,n=>{const e=m.value.max_text||200,a=n?.length||0,p=e-a;a>e&&(s.value.text=n.slice(0,e)),m.value.remaining_text=p>=0?p:0}),(n,e)=>{const a=ne("font-awesome-icon"),p=X,w=Z;return l(),r("div",ce,[M.value?.peran?.guru?(l(),r("div",pe,[t("div",me,[s.value._method!="patch"?(l(),r("div",ge,[t("div",ve,[q(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=i=>s.value.text=i),class:"upload-textarea",rows:"3",placeholder:"Apa yang sedang kamu pikirkan?"},null,512),[[F,s.value.text]]),o.value.posting_new?(l(),P(N,{key:0,class:"spinner-overlay"})):_("",!0)]),t("div",_e,[t("small",{class:b(["char-counter",{warning:m.value.remaining_text<20}])},y(m.value.max_text-m.value.remaining_text)+"/"+y(m.value.max_text),3),t("div",fe,[t("button",{type:"button",class:"upload-btn btn-send",disabled:!s.value.text||o.value.posting_new,onClick:z},[d(a,{icon:["fas","plus"],class:"me-1"}),e[3]||(e[3]=f(" Kirim ",-1))],8,be)])])])):_("",!0),t("div",he,[c.value?.data?.length>0?(l(),r("ul",xe,[(l(!0),r(S,null,L(c.value?.data,(i,g)=>(l(),r("li",{class:b([(s.value.id==i.id&&s.value._method=="patch",""),"list-group-item mb-3 shadow-sm rounded "]),key:g},[s.value.id==i.id&&s.value._method=="patch"?(l(),r("div",ye,[t("div",ke,[q(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=v=>s.value.text=v),class:"upload-textarea",rows:"3",placeholder:"Apa yang sedang kamu pikirkan?"},null,512),[[F,s.value.text]]),o.value.posting_new?(l(),P(N,{key:0,class:"spinner-overlay"})):_("",!0)]),t("div",we,[t("small",{class:b(["char-counter",{warning:m.value.remaining_text<20}])},y(m.value.max_text-m.value.remaining_text)+"/"+y(m.value.max_text),3),t("div",Ce,[s.value.id?(l(),r(S,{key:0},[t("button",{type:"button",class:"upload-btn btn-cancel",disabled:o.value.posting_new,onClick:G}," Batal ",8,Pe),t("button",{type:"button",class:"upload-btn btn-update",disabled:!s.value.text||o.value.posting_new,onClick:J}," Update ",8,Be)],64)):_("",!0)])])])):(l(),r("div",Ve,[t("div",null,[t("div",null,y(i.text),1)]),t("div",De,[t("a",Me,[d(a,{icon:["fas","ellipsis-vertical"]})]),t("ul",Se,[t("li",null,[t("a",{href:"#",class:"dropdown-item",onClick:v=>I(i)},"Edit",8,Ae)]),t("li",null,[t("a",{href:"#",class:"dropdown-item text-danger",onClick:v=>E(i.id)},"Hapus",8,Ne)])])])])),s.value.id==i.id&&s.value._method=="patch"?(l(),r("div",He,[d(p,{class:"disabled btn btn-outline-secondary rounded-pill",to:{}},{default:A(()=>[d(a,{icon:["fas","pen-to-square"],class:"me-1"}),e[4]||(e[4]=f(" Kuis ",-1))]),_:1}),t("button",Ke,[d(a,{icon:["fas","gears"],class:"me-1"}),e[5]||(e[5]=f(" Pengaturan ",-1))]),t("button",$e,[d(a,{icon:["far","paper-plane"],class:"text-prima4y me-1"}),e[6]||(e[6]=f(" Publikasi ",-1))])])):(l(),r("div",qe,[d(p,{class:b([x.value[g]?.kuis?"border border-danger":"","btn-outline-custom"]),to:{name:"kuis-home",params:{id:i.id},query:{tab:"pilihan_ganda"}}},{default:A(()=>[d(a,{icon:["fas","pen-to-square"],class:"me-1"}),e[7]||(e[7]=f(" Kuis ",-1))]),_:1},8,["class","to"]),H.value?(l(),P(p,{key:0,to:{name:"kuis-pengaturan",params:{id:i.id}},class:b([x.value[g]?.pengaturan?"border border-danger":"","btn-outline-custom"])},{default:A(()=>[d(a,{icon:["fas","gears"],class:"me-1"}),e[8]||(e[8]=f(" Pengaturan ",-1))]),_:1},8,["to","class"])):(l(),r("button",{key:1,type:"button",class:b([x.value[g]?.pengaturan?"border border-danger":"","btn-outline-custom"]),"data-bs-toggle":"modal","data-bs-target":"#pengaturanModal",onClick:v=>Y(i)},[d(a,{icon:["fas","gears"],class:"me-1"}),e[9]||(e[9]=f(" Pengaturan ",-1))],10,Fe)),t("button",{onClick:v=>O(i.id,g,"kirim"),type:"button",class:b(["btn-outline-custom"])},[d(a,{icon:["far","paper-plane"],class:"me-1"}),e[10]||(e[10]=f(" Publikasi ",-1))],8,Le)])),(l(!0),r(S,null,L(x.value[g],(v,W)=>(l(),r("span",{class:"small-custom text-danger",key:W},y(v?v+", ":""),1))),128))],2))),128))])):_("",!0),o.value.posting?(l(),P(N,{key:1,class:"position-center"})):_("",!0),c.value?.total>c.value?.per_page?(l(),r("div",Te,[d(w,{modelValue:k.value.page,"onUpdate:modelValue":e[2]||(e[2]=i=>k.value.page=i),"total-items":c.value?.total?c.value.total:1,"items-per-page":c.value?.per_page?c.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):_("",!0)])])])):_("",!0),t("div",null,[d(ue,{loading:o.value.posting_sent,onPageHome:R},null,8,["loading"])]),t("div",Ue,[t("div",je,[t("div",Ee,[t("div",ze,[e[11]||(e[11]=t("h5",{class:"modal-title",id:"pengaturanModalLabel"},"Pengaturan Kuis",-1)),t("a",Ie,[d(a,{class:"fa-2x",icon:["fas","circle-xmark"]})])]),t("div",Ge,[d(re,{data:K.value},null,8,["data"])])])])])])}}});export{vt as default};
