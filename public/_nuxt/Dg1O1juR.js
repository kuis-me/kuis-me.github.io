import{_ as G}from"./BFU05jqY.js";import{_ as Y}from"./BwT3rymJ.js";import{f as H,u as C,G as J,h as Q,i as W,j as X,r as f,S as b,s as N,e as V,c as n,o,a as e,k as B,l as S,m as Z,F as k,q as _,z as M,t as g,L as tt,x as et,aj as ot,b as j,w as A,d as st,n as at}from"#entry";import{d as nt}from"./DoL2xymK.js";const lt={class:"p-3 position-relative"},it={key:1},rt={class:"mb-3"},ut={key:0},dt={class:"list-group list-group-flush"},ct={style:{display:"flex","align-items":"center"}},pt=["src"],gt={key:1},mt={class:"p-2"},vt=["onClick"],ft={class:"btn-group position-relative m-0"},kt={class:"dropdown-menu dropdown-menu-end mt-2","data-bs-auto-close":"outside",style:{width:"300px","max-width":"90vw","min-height":"100px","z-index":"1000"}},_t={class:"mb-2 position-relative"},ht=["value","textContent"],yt={class:"text-end"},wt=["onClick"],bt=["onClick"],xt={key:1,class:"card card-body position-relative",style:{"min-height":"100px"}},Ct={key:2,class:"card-body"},Bt={class:"mb-3"},St={key:0},Tt={class:"list-group list-group-flush"},$t={style:{display:"flex","align-items":"center"}},Ft=["src"],Dt={class:"p-1"},Nt={key:1,class:"position-relative card card-body",style:{"min-height":"100px"}},Vt=H({__name:"FollowUndangan",props:["modelValue"],emits:["data","update:modelValue"],setup(U,{emit:L}){const p=nt(()=>{E()},300);C().$echo,J("user");const h=Q(),P=W();X();const{$axiosAuth:x}=C(),T=L,c=f({}),y=f({kategori:""}),$=f([]),m=f({}),r=f({follow:!1,kategori:!1}),z=U,I=b.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:s=>{s.onmouseenter=b.stopTimer,s.onmouseleave=b.resumeTimer}});async function K(){r.value.kategori=!0;try{let s=await x({method:"post",url:"/other/group"});$.value=s?.data?.data?.kategori,r.value.kategori=!1}catch(s){console.error(s.response?.data||s.message),r.value.kategori=!1}}async function E(){r.value.follow=!0;try{let t=(await x({method:"post",url:"/hubungan/pengikut/undangan"})).data;c.value=await t.data,T("data",c.value),r.value.follow=!1}catch(s){console.error(s.response?.data||s.message),r.value.follow=!1}}async function F(s,t,d=1){r.value.follow=!0;let u=c.value.data[d];u.loading=!0,m.value={};const a=new FormData;a.append("profil_id",s),a.append("status",t),a.append("kategori_id",y.value?.kategori?.id),a.append("kategori",y.value?.kategori?.text);try{let i=await x({method:"post",url:"/hubungan/pengikut/store",data:a}),l=i.data;l.status==!1&&(m.value=l?.errors,console.log(m.value)),p();const D=i.data?.status;r.value.follow=!1,u.loading=!1}catch(i){console.error(i.response?.data||i.message),m.value=i.response?.data?.errors,r.value.follow=!1,u.loading=!1}}async function O(s){await at({name:"profil",params:{user:s}})}async function R(s,t,d){(await b.fire({title:"Apakah Anda yakin ingin menolak permitaan?",text:"Proses tidak dapat dibatalkan.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, tolak!",cancelButtonText:"Batal"})).isConfirmed&&F(s,t,d)}N(()=>z.refresh,s=>{s&&(p(),T("update:modelValue",!1))}),N(()=>h.get("refresh-page"),async(s,t)=>{s!==t&&await p()});const{$pusher:Mt,$pusherUtils:q}=C();let w=null;return V(()=>{const t=h.get("profil")?.data?.user_id;w&&w.unsubscribe(),w=q.reload().subscribe(`private-App.Models.User.${t}`),w.bind("Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",u=>{u.title&&(I.fire({icon:"info",title:u.title+" "+u.body}),p())})}),V(async()=>{h.get("getFollow"),p(),h.set("getFollow",!0)}),(s,t)=>{const d=G,u=Y;return o(),n("div",null,[e("div",lt,[r.value.follow?(o(),B(d,{key:0,class:"position-center"})):S("",!0),Z(P).name!=="xx"?(o(),n("div",it,[e("div",rt,[t[8]||(t[8]=e("div",{class:"judul"},"Ingin Mengikuti anda",-1)),c.value.data?.length?(o(),n("div",ut,[e("ul",dt,[(o(!0),n(k,null,_(c.value.data,(a,i)=>(o(),n("li",{class:"list-group-item position-relative",key:i},[e("div",ct,[a.image_show?(o(),n("img",{key:0,src:a.image_show,alt:"Foto",class:"avatar-50"},null,8,pt)):(o(),n("div",gt,[e("div",{class:"avatar-50 profile-img",style:M({backgroundColor:a.color})},g(a.nama_inisial),5)])),e("div",mt,[e("div",null,[e("strong",null,g(a.nama_lengkap?a.nama_lengkap:""),1)]),e("div",null,[e("button",{type:"button",class:"btn-xs me-1 btn-purple-pink",href:"#",onClick:l=>O(a.username)},"Lihat",8,vt),e("div",ft,[t[6]||(t[6]=e("button",{type:"button",class:"btn-xs me-1 btn-purple-pink","data-bs-toggle":"dropdown","aria-expanded":"false"},"Terima",-1)),e("div",kt,[e("div",{onClick:t[2]||(t[2]=tt(()=>{},["stop"])),class:"p-2"},[(o(!0),n(k,null,_(m.value,(l,v)=>(o(),n("div",{key:v},[(o(!0),n(k,null,_(l,(D,jt)=>(o(),n("p",{key:v,class:"alert alert-danger"},g(D),1))),128))]))),128)),t[5]||(t[5]=e("div",{class:"text-center"},"Masukan kategori",-1)),e("div",_t,[et(e("select",{class:"form-control form-control-sm","onUpdate:modelValue":t[0]||(t[0]=l=>y.value.kategori=l),onFocus:t[1]||(t[1]=l=>K())},[t[3]||(t[3]=e("option",{value:"",disabled:"",selected:""},"Pilih opsi",-1)),(o(!0),n(k,null,_($.value,(l,v)=>(o(),n("option",{key:v,value:l,textContent:g(l.text)},null,8,ht))),128))],544),[[ot,y.value.kategori]]),r.value.kategori?(o(),B(d,{key:0,class:"position-center"})):S("",!0)]),e("div",yt,[e("small",null,[j(u,{class:"text-end",to:{name:"home-setting"}},{default:A(()=>[...t[4]||(t[4]=[st("+ Kategori",-1)])]),_:1})])]),e("button",{type:"button",class:"btn-outline-custom text-end",onClick:l=>F(a.id,"terima",i)},"Terima",8,wt)])])]),e("button",{type:"button",class:"btn-xs m1-1 btn-purple-pink",onClick:l=>R(a.id,"tolak",i)},"Tolak ",8,bt)])])]),a?.loading?(o(),B(d,{key:0,class:"position-center"})):S("",!0)]))),128))])])):(o(),n("div",xt,[...t[7]||(t[7]=[e("div",{class:"position-center text-center"}," Kosong ",-1)])]))])])):(o(),n("div",Ct,[e("div",Bt,[t[11]||(t[11]=e("div",{class:"judul"},"Permintaan hubungan",-1)),c.value.data?.length?(o(),n("div",St,[e("ul",Tt,[(o(!0),n(k,null,_(c.value.data,(a,i)=>(o(),n("li",{class:"list-group-item position-relative",key:i},[j(u,{to:{name:"home-notifikasi"}},{default:A(()=>[e("div",$t,[a.image_show?(o(),n("img",{key:0,src:a.image_show,alt:"Foto",class:"avatar-50"},null,8,Ft)):(o(),n("div",{key:1,class:"avatar-50",style:M({background:a.color})},g(a.nama_inisial),5)),e("div",Dt,[e("div",null,[e("strong",null,g(a.nama_lengkap?a.nama_lengkap:""),1)]),t[9]||(t[9]=e("div",null," Ingin mengikuti anda ",-1))])])]),_:2},1024)]))),128))])])):(o(),n("div",Nt,[...t[10]||(t[10]=[e("div",{class:"position-center text-center"}," Kosong ",-1)])]))])]))])])}}}),zt=Object.assign(Vt,{__name:"FollowUndangan"});export{zt as _};
