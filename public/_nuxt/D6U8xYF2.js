import{_ as la}from"./CwQB-XB4.js";import{_ as ia}from"./QraDVNg7.js";import{_ as ra}from"./DCdpMFYG.js";import{_ as R}from"./BFU05jqY.js";import{u as G,r as _,G as C,e as W,c as l,o as n,l as b,k as V,F as h,q as Y,a,I as P,t as r,H as J,f as da,h as ca,j as ua,i as pa,z as E,C as ga,b as i,A as O,N as ma,w as U,m as _a,S as va,n as ka}from"#entry";import{_ as fa}from"./DlAUqK2U.js";import{_ as z}from"./DmRUS9VP.js";import{d as ha}from"./DoL2xymK.js";const ya={class:"container"},ba={class:"d-flex align-items-center gap-3"},xa={class:"user-name"},wa={class:"points"},Ca={class:"flex-grow-1 ms-3"},$a={class:"progress"},Da={key:0,class:"text-center text-muted mt-4"},Sa={__name:"PeringkatNilai",props:{data:{type:Object,required:!1,default:()=>({})}},setup(I){const $=I,{$axiosAuth:v}=G(),x=_([]),k=_({...$.data}),D=_({peringkat:!1});C(()=>$.data,p=>{k.value={...p},p?.id&&B()},{deep:!0,immediate:!0});async function B(){D.value.peringkat=!0;const p=new FormData;p.append("unggahan_id",$.data?.id);try{const d=await v({method:"post",url:"/unggahan/kuis/peringkat",data:p});x.value=d.data||[],D.value.peringkat=!1}catch(d){console.error(d.response?.data||d.message),D.value.peringkat=!1}}function j(p){if(!x.value.length)return 0;const d=Math.max(...x.value.map(u=>u.total_skor||0));return d?(p/d*100).toFixed(1):0}function M(p){const d=["bg-primary","bg-success","bg-info","bg-warning","bg-danger","bg-secondary"];return d[p%d.length]}return W(async()=>{$.data?.id&&await B()}),(p,d)=>{const u=R;return n(),l("div",ya,[(n(!0),l(h,null,Y(x.value,(g,y)=>(n(),l("div",{key:y,class:"ranking-card d-flex align-items-center justify-content-between"},[a("div",ba,[a("div",{class:P(["rank-badge","rank-"+(y+1)])},r(y+1),3),a("div",null,[a("div",xa,r(g.nama),1),a("div",wa,r(g.total_skor)+" pts",1)])]),a("div",Ca,[a("div",$a,[a("div",{class:P(["progress-bar",M(y)]),role:"progressbar",style:J({width:j(g.total_skor)+"%"})},null,6)])])]))),128)),x.value?.length?b("",!0):(n(),l("div",Da)),D.value.peringkat?(n(),V(u,{key:1,class:"position-center"})):b("",!0)])}}},Ba=fa(Sa,[["__scopeId","data-v-f30f34da"]]),ja={class:"position-relative"},Na={class:"search-bar mb-1 mb-md-3 position-relative"},Pa={key:0,class:"mb-3"},Fa={class:"card",style:{"min-height":"300px"}},Aa={class:"card-body position-relative"},Ta={class:"position-center"},za={key:1,class:"mb-3"},Ia={key:0},Ma={class:"card shadow-sm"},qa={class:"card-body"},Ha={class:"d-flex justify-content-between align-items-start"},La={class:"row align-items-start"},Ua={class:"col-auto"},Va=["onClick"],Ka=["onClick"],Ea={class:"col"},Oa=["onClick"],Ra={class:"small-custom text-start"},Ga={class:"small-custom text-start"},Wa={class:"mb-2 small-"},Ya={class:"text-end d-none d-md-block"},Ja={class:"small-custom mapel-kuis"},Qa={class:"small-custom"},Xa={class:"d-md-none d-block"},Za={class:"small-custom text-center mapel-kuis"},as={class:"small-custom text-center"},ss={class:"row"},ts={class:"col-sm-12 p-2"},es={class:"position-relative"},ns={class:"d-flex justify-content-between align-items-center mt-3"},os={class:"d-flex gap-3 flex-wrap text-secondary position-relative"},ls=["onClick"],is={class:"ms-1"},rs=["onClick"],ds={class:"ms-1"},cs=["onClick"],us={class:"ms-1"},ps={key:0,class:"position-absolute top-0 end-0 m-4"},gs={class:"dropdown"},ms={role:"button","data-bs-toggle":"dropdown"},_s={class:"dropdown-menu shadow-sm"},vs=["onClick"],ks=["onClick"],fs=["onClick"],hs=["onClick"],ys={key:2,class:"m-2 float-end"},bs={class:"modal fade",id:"peringkat","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},xs={class:"modal-dialog modal-dialog-scrollable"},ws={class:"modal-content"},Cs={class:"modal-header position-relative text-center"},$s={type:"button",class:"btn right-top","data-bs-dismiss":"modal","aria-label":"Close"},Ds={class:"modal-body"},Ss=da({__name:"PostingsShow",props:{loading:{type:Boolean,default:!1}},emits:["pageHome"],setup(I,{emit:$}){const v=ha(()=>{A()},300),x=I,k=ca(),D=ua(),B=pa(),j=B.params.user,M=_(1),p=_({page:1}),d=_({}),u=_({data:[]}),g=_({}),y=_(""),{$axiosAuth:F}=G(),m=_({cari:"",page:1});j?y.value="/profil/"+j+"/unggahan":y.value="/unggahan/terkirim";async function A(){g.value.unggahan=!0;try{let s=(await F({method:"post",url:y.value,params:m.value})).data;s.status==!0?u.value=s?.data:d.value=s,g.value.unggahan=!1}catch(e){console.log(e.response?.data),g.value.unggahan=!1}}async function Q(e,s){g.value.unggahan=!0;const o=new FormData;o.append("id",e);try{let S=(await F({method:"post",url:"/unggahan/draf/back",data:o})).data;A(),sa(),g.value.unggahan=!1}catch(c){console.error(c.response?.data||c.message),g.value.posting_sent=!1,g.value.unggahan=!1}}async function X(e){if((await va.fire({title:"Apakah Anda yakin?",text:"Data ini tidak dapat dikembalikan setelah dihapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const o=await F({method:"delete",url:"/unggahan/"+e+"/delete"});A()}catch(o){console.error(o.response?.data||o.message)}}async function q(e,s,o){let c=u.value.data[e];c.loading=!0;const S=new FormData;S.append("unggahan_id",s),S.append("reaksi",o);try{let w=(await F({method:"post",url:"/unggahan/reaksi/store",data:S})).data;c.tidak_suka_count=w.tidak_suka,c.suka_count=w.suka,c.reaksi_ku=w.reaksi,c.mark=w.mark,c.loading=!1,o=="mark"&&k.set("tanda",w.mark)}catch(N){console.error(N.response?.data||N.message),c.loading=!1}}async function H(e){await ka({name:"profil",params:{user:e}})}function Z(){m.value.cari=""}W(async()=>{let e=B.query.page;e&&(M.value=Number(e)||1),v()}),C(()=>k.get("refresh-page"),(e,s)=>{e!=s&&v()}),C(()=>x.loading,(e,s)=>{e!==s&&v()}),C(m,(e,s)=>{p.value.page=e.page,D.push({query:{page:e.page}}),v()},{deep:!0}),C(()=>k.get("tanda"),(e,s)=>{e!==s&&v()});const L=_(!1);C(()=>k.get("cari_unggahan"),e=>{e?m.value.cari!==e&&(L.value=!0,m.value.cari=e,v()):m.value.cari=null}),C(()=>m.value.cari,(e,s)=>{e!==s&&(L.value?L.value=!1:(k.get("cari_unggahan")&&k.clear("cari_unggahan"),k.set("cari",!0),v()))});const aa=$;function sa(){aa("pageHome")}const ta=async e=>{if(navigator.share)try{await navigator.share({url:e})}catch(s){console.log("User batal share",s)}else window.open("https://wa.me/?text="+window.location.origin+e,"_blank")},K=_({});function ea(e){K.value=e}return(e,s)=>{const o=O("font-awesome-icon"),c=la,S=ia,N=ra,w=O("FontAwesomeIcon"),na=Ba,oa=ma("lazy");return n(),l("div",ja,[a("div",Na,[E(a("input",{type:"text",onKeyup:s[0]||(s[0]=t=>A()),"onUpdate:modelValue":s[1]||(s[1]=t=>m.value.cari=t),placeholder:"Cari Unggahan ID / Nama"},null,544),[[ga,m.value.cari]]),m.value.cari?(n(),l("button",{key:0,onClick:s[2]||(s[2]=t=>Z()),type:"button",class:"btn right-center-20"},[i(o,{icon:["fas","circle-xmark"],class:"text-secondary"})])):b("",!0)]),d.value.message?(n(),l("div",Pa,[a("div",Fa,[a("div",Aa,[a("div",Ta,[a("div",null,[i(o,{icon:["fas","users-slash"],class:"fa-4x text-secondary"})]),a("div",null,r(d.value.message),1)])])])])):(n(),l("div",za,[a("div",null,[u.value.data.length<1?(n(),l("div",Ia,[...s[4]||(s[4]=[a("div",{class:"card",style:{"min-height":"300px"}},[a("div",{class:"card-body d-flex justify-content-center align-items-center"},[a("div",{class:"text-center"}," Belum ada unggahan ")])],-1)])])):(n(!0),l(h,{key:1},Y(u.value.data,(t,T)=>(n(),l("div",{class:"list-group-item position-relative mb-3",key:T},[a("div",Ma,[a("div",qa,[a("div",Ha,[a("div",La,[a("div",Ua,[t.profil.image_show?E((n(),l("img",{key:0,class:"profil-img avatar-50 lazy-img",onClick:f=>H(t.profil.username)},null,8,Va)),[[oa,t.profil.image_show]]):(n(),l("div",{key:1,style:J({backgroundColor:t.profil.color}),class:"avatar-50 profile-img",onClick:f=>H(t.profil.username)},r(t.profil.nama_inisial),13,Ka))]),a("div",Ea,[a("div",{class:"fw-bold cursor-pointer",onClick:f=>H(t.profil.username)},r(t.profil.nama_lengkap),9,Oa),a("div",Ra,"ID: "+r(t.id_ref),1),a("div",Ga,r(t.created_at_for_humans),1)]),s[5]||(s[5]=a("div",{class:"text-muted small"},null,-1))]),s[6]||(s[6]=a("div",{class:"col-sm-6 text-muted small",style:{"margin-top":"-10px","padding-top":"-10px !important"}},null,-1))]),s[17]||(s[17]=a("hr",{class:"my-2"},null,-1)),a("div",Wa,[a("div",Ya,[a("span",Ja,r(t.kuis?.mata_pelajaran),1),a("span",Qa," ⏰ "+r(t.waktu_mulai_dinamis)+" – "+r(t.waktu_selesai_dinamis),1)]),a("div",Xa,[a("div",Za,r(t.kuis?.mata_pelajaran),1),a("div",as," ⏰ "+r(t.waktu_mulai_dinamis)+" – "+r(t.waktu_selesai_dinamis),1)]),a("div",ss,[a("div",ts,[a("div",es,[a("div",null,r(t.text||""),1)])])])]),a("div",ns,[a("div",null,[a("div",null,[i(c,{to:{name:"kuis-persiapan",params:{user:t.profil.username,id:t.id}},class:"btn-outline-custom",style:{gap:"0.5rem"}},{default:U(()=>[t?.status_jawab=="selesai"?(n(),l(h,{key:0},[i(o,{icon:["fas","check"],width:"20",height:"20"}),s[7]||(s[7]=a("span",{class:"text-success"}," Selesai",-1))],64)):t?.status_jawab=="dijawab"?(n(),l(h,{key:1},[i(o,{icon:["fas","check"],width:"20",height:"20"}),s[8]||(s[8]=a("span",{class:"text-success"},"Telah Dijawab",-1))],64)):t?.status_kuis=="tutup"?(n(),l(h,{key:2},[s[9]||(s[9]=a("img",{src:z,width:"20",height:"20"},null,-1)),s[10]||(s[10]=a("span",null," Tutup",-1))],64)):t?.status_kuis=="berlangsung"?(n(),l(h,{key:3},[s[11]||(s[11]=a("img",{src:z,width:"20",height:"20"},null,-1)),s[12]||(s[12]=a("span",null," Berlangsung",-1))],64)):t?.status_kuis=="dijawab"?(n(),l(h,{key:4},[s[13]||(s[13]=a("img",{src:z,width:"20",height:"20"},null,-1)),s[14]||(s[14]=a("span",null,"Telah Dijawab",-1))],64)):(n(),l(h,{key:5},[s[15]||(s[15]=a("img",{src:z,width:"20",height:"20"},null,-1)),s[16]||(s[16]=a("span",null," Belum dimulai",-1))],64))]),_:2},1032,["to"])])]),a("div",os,[a("button",{class:"btn p-0 text-secondary",onClick:f=>q(T,t.id,"suka"),title:"Suka"},[i(o,{icon:["fas","heart"],class:P({"text-danger":t.reaksi_ku==="suka"})},null,8,["class"]),a("span",is,r(t.suka_count),1)],8,ls),a("button",{class:"btn p-0 text-secondary",onClick:f=>q(T,t.id,"tidak suka"),title:"Tidak Suka"},[i(o,{icon:["fas","heart-crack"],class:P({"text-danger":t.reaksi_ku==="tidak suka"})},null,8,["class"]),a("span",ds,r(t.tidak_suka_count),1)],8,rs),a("button",{class:"btn p-0 text-secondary",onClick:f=>q(T,t.id,"mark"),title:"Favorit"},[i(o,{icon:["fas","bookmark"],class:P({"text-danger":t.mark})},null,8,["class"])],8,cs),i(c,{to:{name:"tanggapan",params:{user:t.profil.username,id:t.id}},class:"text-secondary text-decoration-none small",title:"Komentar"},{default:U(()=>[i(o,{icon:["fas","comments"]}),a("span",us,r(t.tanggapan_all_count??0),1)]),_:2},1032,["to"]),t.loading?(n(),V(S,{key:0,class:"position-center"})):b("",!0)])])]),_a(j)?b("",!0):(n(),l("div",ps,[a("div",gs,[a("a",ms,[i(o,{icon:["fas","ellipsis-vertical"],class:"text-secondary"})]),a("ul",_s,[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:f=>ta(`/${t.profil.username}/unggahan/${t.id}`)},[i(o,{icon:["fas","share-nodes"]}),s[18]||(s[18]=a("span",null,"Bagikan",-1))],8,vs)]),a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:f=>ea(t),"data-bs-toggle":"modal","data-bs-target":"#peringkat"},[i(o,{icon:["fas","ranking-star"]}),s[19]||(s[19]=a("span",null,"Peringkat",-1))],8,ks)]),t.miliku?(n(),l(h,{key:0},[a("li",null,[a("a",{href:"#",class:"dropdown-item d-flex align-items-center gap-2",onClick:f=>Q(t.id,t.text)},[i(o,{icon:["fas","file-pen"]}),s[20]||(s[20]=a("span",null,"Kembalikan ke Draf",-1))],8,fs)]),a("li",null,[i(c,{to:{name:"kuis-laporan",params:{id:t.id}},class:"dropdown-item d-flex align-items-center gap-2"},{default:U(()=>[i(o,{icon:["fas","chart-line"]}),s[21]||(s[21]=a("span",null,"Laporan",-1))]),_:1},8,["to"])]),a("li",null,[a("a",{href:"#",class:"dropdown-item text-danger d-flex align-items-center gap-2",onClick:f=>X(t.id)},[i(o,{icon:["fas","trash"]}),s[22]||(s[22]=a("span",null,"Hapus",-1))],8,hs)])],64)):b("",!0)])])]))])]))),128))])])),u.value.total>u.value.per_page?(n(),l("div",ys,[i(N,{modelValue:m.value.page,"onUpdate:modelValue":s[3]||(s[3]=t=>m.value.page=t),"total-items":u.value.total?u.value.total:1,"items-per-page":u.value.per_page?u.value.per_page:1},null,8,["modelValue","total-items","items-per-page"])])):b("",!0),g.value.unggahan?(n(),V(R,{key:3,class:"position-center"})):b("",!0),a("div",bs,[a("div",xs,[a("div",ws,[a("div",Cs,[s[23]||(s[23]=a("h2",{class:"text-center mb-4"},"🏆 Leaderboard",-1)),a("button",$s,[i(w,{icon:["fa","circle-xmark"],class:"fa-2x"})])]),a("div",Ds,[i(na,{data:K.value},null,8,["data"])])])])])])}}}),Is=Object.assign(Ss,{__name:"PostingsShow"});export{Is as P};
